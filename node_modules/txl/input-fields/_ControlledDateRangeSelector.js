'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = undefined;

var _extends2 = require('babel-runtime/helpers/extends');

var _extends3 = _interopRequireDefault(_extends2);

var _getPrototypeOf = require('babel-runtime/core-js/object/get-prototype-of');

var _getPrototypeOf2 = _interopRequireDefault(_getPrototypeOf);

var _classCallCheck2 = require('babel-runtime/helpers/classCallCheck');

var _classCallCheck3 = _interopRequireDefault(_classCallCheck2);

var _createClass2 = require('babel-runtime/helpers/createClass');

var _createClass3 = _interopRequireDefault(_createClass2);

var _possibleConstructorReturn2 = require('babel-runtime/helpers/possibleConstructorReturn');

var _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);

var _inherits2 = require('babel-runtime/helpers/inherits');

var _inherits3 = _interopRequireDefault(_inherits2);

var _slicedToArray2 = require('babel-runtime/helpers/slicedToArray');

var _slicedToArray3 = _interopRequireDefault(_slicedToArray2);

var _class;

var _react = require('react');

var _react2 = _interopRequireDefault(_react);

var _radium = require('radium');

var _radium2 = _interopRequireDefault(_radium);

var _moment = require('moment');

var _moment2 = _interopRequireDefault(_moment);

var _isEqual = require('lodash/isEqual');

var _isEqual2 = _interopRequireDefault(_isEqual);

var _Base = require('../base/Base');

var _CalendarUtils = require('../calendar-picker/_CalendarUtils');

var _propTypes = require('../utils/propTypes');

var _propTypes2 = _interopRequireDefault(_propTypes);

var _Button = require('../buttons/Button');

var _Button2 = _interopRequireDefault(_Button);

var _CalendarOutline = require('../icons/CalendarOutline');

var _CalendarOutline2 = _interopRequireDefault(_CalendarOutline);

var _CalendarPickerWithPresets = require('../calendar-picker/CalendarPickerWithPresets');

var _CalendarPickerWithPresets2 = _interopRequireDefault(_CalendarPickerWithPresets);

var _DropdownContent = require('../dropdowns/_DropdownContent');

var _DropdownContent2 = _interopRequireDefault(_DropdownContent);

var _IconButton = require('../buttons/IconButton');

var _IconButton2 = _interopRequireDefault(_IconButton);

var _InputUnderline = require('../layout/_InputUnderline');

var _InputUnderline2 = _interopRequireDefault(_InputUnderline);

var _TextField = require('../input-fields/TextField');

var _TextField2 = _interopRequireDefault(_TextField);

var _TimeZonePicker = require('../input-fields/_TimeZonePicker');

var _TimeZonePicker2 = _interopRequireDefault(_TimeZonePicker);

var _TimePickerControlled = require('../input-fields/TimePickerControlled');

var _TimePickerControlled2 = _interopRequireDefault(_TimePickerControlled);

var _DateRangeSelector = require('./DateRangeSelector.style');

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

var _DATE_RANGE_PRESETS$f = _CalendarUtils.DATE_RANGE_PRESETS.filter(function (preset) {
  return preset.key === 'today';
}),
    _DATE_RANGE_PRESETS$f2 = (0, _slicedToArray3.default)(_DATE_RANGE_PRESETS$f, 1),
    todayPreset = _DATE_RANGE_PRESETS$f2[0];

var DEFAULT_DATE_INPUT_PATTERN = 'YYYY-MM-DD';
var CONDENSED_DATE_FORMAT = 'MMM D, YYYY';
var TIME_PATTERN = 'hh:mm:ss A';

// @TODO translate
var APPLY_BUTTON_TEXT = 'Apply';
var CANCEL_BUTTON_TEXT = 'Cancel';
var TIME_RANGE_PICKER_LABEL = 'Time range';
var TIME_ZONE_PICKER_LABEL = 'Time zone';
var TIME_DELIMITER_TEXT = 'to';

// Convert time string that matches pattern to { hour, minute, second } obj
var _mapStringToTime = function _mapStringToTime(timeStr) {
  var timeMoment = (0, _moment2.default)(timeStr, TIME_PATTERN, true);
  return timeMoment.isValid() ? (0, _CalendarUtils.timeObjFromMoment)(timeMoment) : null;
};

// value prop comes through from "Create New", m/h/s obj comes from item select handler
var _getTimeFromItemSelect = function _getTimeFromItemSelect(_ref) {
  var hour = _ref.hour,
      minute = _ref.minute,
      second = _ref.second,
      value = _ref.value;
  return value ? _mapStringToTime(value) : { hour: hour, minute: minute, second: second };
};

var _formatTime = function _formatTime(timeObj) {
  return timeObj !== null ? (0, _moment2.default)(timeObj).format(TIME_PATTERN) : '';
};

function hasDateRangeChanged(existingRange, activeRange) {
  var _existingRange = (0, _slicedToArray3.default)(existingRange, 2),
      existingStart = _existingRange[0],
      existingEnd = _existingRange[1];

  var _activeRange = (0, _slicedToArray3.default)(activeRange, 2),
      activeStart = _activeRange[0],
      activeEnd = _activeRange[1];

  return existingStart && existingEnd && (!existingStart.isSame(activeStart, 'day') || !existingEnd.isSame(activeEnd, 'day'));
}

function hasTimeRangeChanged(_ref2, _ref3) {
  var startTime = _ref2.startTime,
      endTime = _ref2.endTime;
  var activeStartTime = _ref3.activeStartTime,
      activeEndTime = _ref3.activeEndTime;

  return !(0, _isEqual2.default)(startTime, activeStartTime) || !(0, _isEqual2.default)(endTime, activeEndTime);
}

function hasNewSelectedValue(props, state) {
  var timeZone = props.timeZone,
      value = props.value;
  var activeRange = state.activeRange,
      activeTimeZone = state.activeTimeZone;


  return hasDateRangeChanged(value.map(_CalendarUtils.dateStringToMoment), activeRange) || hasTimeRangeChanged(props, state) || timeZone !== activeTimeZone;
}

function buildDisplayValueFromDates(startDate, endDate, pattern) {
  var isValidRange = startDate && endDate && (0, _CalendarUtils.isValidDateRange)(startDate, endDate);
  return isValidRange ? [startDate, endDate].map(function (date) {
    return (0, _moment2.default)(date).format(pattern);
  }).join(' - ') : '';
}

function buildTimeRangeSecondaryText(dateString) {
  return dateString ? (0, _moment2.default)(dateString).format(CONDENSED_DATE_FORMAT) : '';
}

function areDatesInRange(_ref4) {
  var start = _ref4.start,
      end = _ref4.end,
      rangeEndBoundary = _ref4.rangeEndBoundary,
      rangeStartBoundary = _ref4.rangeStartBoundary;

  return (0, _CalendarUtils.isDateWithinRange)(start, rangeStartBoundary, rangeEndBoundary, true) && (0, _CalendarUtils.isDateWithinRange)(end, rangeStartBoundary, rangeEndBoundary, true);
}

function isApplyButtonDisabled(props, state) {
  var rangeEndBoundary = props.rangeEndBoundary,
      rangeStartBoundary = props.rangeStartBoundary;

  var activeEndTime = state.activeEndTime,
      activeStartTime = state.activeStartTime,
      _state$activeRange = (0, _slicedToArray3.default)(state.activeRange, 2),
      activeStartDate = _state$activeRange[0],
      activeEndDate = _state$activeRange[1];

  // no new value, button still disabled


  if (!hasNewSelectedValue(props, state)) {
    return true;
  }

  // new value with no boundaries, button enabled
  if (!rangeEndBoundary || !rangeStartBoundary) {
    return false;
  }

  // new value with boundaries provided, check that date falls in range
  return !areDatesInRange({
    end: activeEndDate.clone().set(activeEndTime),
    rangeEndBoundary: rangeEndBoundary,
    rangeStartBoundary: rangeStartBoundary,
    start: activeStartDate.clone().set(activeStartTime)
  });
}

// As date range selection changes, we need to update the boundaries that we send to each
// TimePicker for validating dates *and* times are in range
function buildTimeBoundaries(_ref5) {
  var startDate = _ref5.startDate,
      endDate = _ref5.endDate,
      rangeStartBoundary = _ref5.rangeStartBoundary,
      rangeEndBoundary = _ref5.rangeEndBoundary;

  if (!rangeStartBoundary || !rangeEndBoundary) {
    return {};
  }

  // init with defaults: all hours of day
  var boundaries = {
    endTimeBoundaryEnd: (0, _CalendarUtils.timeObjFromMoment)((0, _moment2.default)().endOf('day')),
    endTimeBoundaryStart: (0, _CalendarUtils.timeObjFromMoment)((0, _moment2.default)().startOf('day')),
    startTimeBoundaryEnd: (0, _CalendarUtils.timeObjFromMoment)((0, _moment2.default)().endOf('day')),
    startTimeBoundaryStart: (0, _CalendarUtils.timeObjFromMoment)((0, _moment2.default)().startOf('day'))
  };

  if (startDate.isSame(rangeStartBoundary, 'day')) {
    boundaries.startTimeBoundaryStart = (0, _CalendarUtils.timeObjFromMoment)(rangeStartBoundary);
  }
  if (startDate.isSame(rangeEndBoundary, 'day')) {
    boundaries.startTimeBoundaryEnd = (0, _CalendarUtils.timeObjFromMoment)(rangeEndBoundary);
  }
  if (endDate.isSame(rangeStartBoundary, 'day')) {
    boundaries.endTimeBoundaryStart = (0, _CalendarUtils.timeObjFromMoment)(rangeStartBoundary);
  }
  if (endDate.isSame(rangeEndBoundary, 'day')) {
    boundaries.endTimeBoundaryEnd = (0, _CalendarUtils.timeObjFromMoment)(rangeEndBoundary);
  }
  return boundaries;
}

var TxlDateRangeSelector = (0, _radium2.default)(_class = function (_React$Component) {
  (0, _inherits3.default)(TxlDateRangeSelector, _React$Component);

  function TxlDateRangeSelector() {
    var _ref6;

    (0, _classCallCheck3.default)(this, TxlDateRangeSelector);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = (0, _possibleConstructorReturn3.default)(this, (_ref6 = TxlDateRangeSelector.__proto__ || (0, _getPrototypeOf2.default)(TxlDateRangeSelector)).call.apply(_ref6, [this].concat(args)));

    _this._handleDateSelect = function () {
      return _this.___handleDateSelect__REACT_HOT_LOADER__.apply(_this, arguments);
    };

    _this._handleTimeZoneSelect = function () {
      return _this.___handleTimeZoneSelect__REACT_HOT_LOADER__.apply(_this, arguments);
    };

    _this._handleApplyClick = function () {
      return _this.___handleApplyClick__REACT_HOT_LOADER__.apply(_this, arguments);
    };

    _this._handleDateChange = function () {
      return _this.___handleDateChange__REACT_HOT_LOADER__.apply(_this, arguments);
    };

    _this._toggleDropdown = function () {
      return _this.___toggleDropdown__REACT_HOT_LOADER__.apply(_this, arguments);
    };

    _this._closeDropdown = function () {
      return _this.___closeDropdown__REACT_HOT_LOADER__.apply(_this, arguments);
    };

    _this._openDropdown = function () {
      return _this.___openDropdown__REACT_HOT_LOADER__.apply(_this, arguments);
    };

    _this._handleEndTimeClose = function () {
      return _this.___handleEndTimeClose__REACT_HOT_LOADER__.apply(_this, arguments);
    };

    _this._handleEndTimeOpen = function () {
      return _this.___handleEndTimeOpen__REACT_HOT_LOADER__.apply(_this, arguments);
    };

    _this._handleEndTimeRef = function () {
      return _this.___handleEndTimeRef__REACT_HOT_LOADER__.apply(_this, arguments);
    };

    _this._handleEndTimeSelect = function () {
      return _this.___handleEndTimeSelect__REACT_HOT_LOADER__.apply(_this, arguments);
    };

    _this._handleStartTimeClose = function () {
      return _this.___handleStartTimeClose__REACT_HOT_LOADER__.apply(_this, arguments);
    };

    _this._handleStartTimeOpen = function () {
      return _this.___handleStartTimeOpen__REACT_HOT_LOADER__.apply(_this, arguments);
    };

    _this._handleStartTimeRef = function () {
      return _this.___handleStartTimeRef__REACT_HOT_LOADER__.apply(_this, arguments);
    };

    _this._handleStartTimeSelect = function () {
      return _this.___handleStartTimeSelect__REACT_HOT_LOADER__.apply(_this, arguments);
    };

    var _this$props = _this.props,
        endTime = _this$props.endTime,
        presetKey = _this$props.presetKey,
        rangeEndBoundary = _this$props.rangeEndBoundary,
        rangeStartBoundary = _this$props.rangeStartBoundary,
        startTime = _this$props.startTime,
        timeZone = _this$props.timeZone,
        value = _this$props.value,
        _this$props$value = (0, _slicedToArray3.default)(_this$props.value, 2),
        startDate = _this$props$value[0],
        endDate = _this$props$value[1];

    // maintain 'active' date within component for updating Calendars when not auto-updating.


    _this.state = {
      activeEndTime: endTime,
      activePreset: presetKey,
      activeRange: value.map(_CalendarUtils.dateStringToMoment),
      activeStartTime: startTime,
      activeTimeZone: timeZone,
      endTimeOpen: false,
      startTimeOpen: false,
      timeBoundaries: buildTimeBoundaries({
        endDate: endDate,
        rangeEndBoundary: rangeEndBoundary,
        rangeStartBoundary: rangeStartBoundary,
        startDate: startDate
      })
    };
    return _this;
  }

  (0, _createClass3.default)(TxlDateRangeSelector, [{
    key: 'componentWillReceiveProps',
    value: function componentWillReceiveProps(nextProps) {
      this.setState({
        activeEndTime: nextProps.endTime,
        activePreset: nextProps.presetKey,
        activeRange: nextProps.value.map(_CalendarUtils.dateStringToMoment),
        activeStartTime: nextProps.startTime,
        activeTimeZone: nextProps.timeZone
      });
    }
  }, {
    key: '___handleDateSelect__REACT_HOT_LOADER__',
    value: function ___handleDateSelect__REACT_HOT_LOADER__() {
      return this.___handleDateSelect__REACT_HOT_LOADER__.apply(this, arguments);
    }
  }, {
    key: '___handleDateSelect__REACT_HOT_LOADER__',
    value: function ___handleDateSelect__REACT_HOT_LOADER__() {
      return this.___handleDateSelect__REACT_HOT_LOADER__.apply(this, arguments);
    }
  }, {
    key: '___handleDateSelect__REACT_HOT_LOADER__',
    value: function ___handleDateSelect__REACT_HOT_LOADER__(_ref7) {
      var _this2 = this;

      var presetKey = _ref7.presetKey,
          startDate = _ref7.startDate,
          endDate = _ref7.endDate;

      var newDateState = {
        activePreset: presetKey,
        activeRange: [startDate, endDate]
      };
      if (presetKey !== 'custom') {
        newDateState = (0, _extends3.default)({}, newDateState, {
          activeEndTime: (0, _CalendarUtils.timeObjFromMoment)(endDate),
          activeStartTime: (0, _CalendarUtils.timeObjFromMoment)(startDate)
        });
      }
      this.setState(newDateState, function () {
        if (_this2.props.mode === 'simple') {
          // apply date immediately
          _this2._handleDateChange({ endDate: endDate, presetKey: presetKey, startDate: startDate });
        }
      });
    }
  }, {
    key: '___handleTimeZoneSelect__REACT_HOT_LOADER__',
    value: function ___handleTimeZoneSelect__REACT_HOT_LOADER__() {
      return this.___handleTimeZoneSelect__REACT_HOT_LOADER__.apply(this, arguments);
    }
  }, {
    key: '___handleTimeZoneSelect__REACT_HOT_LOADER__',
    value: function ___handleTimeZoneSelect__REACT_HOT_LOADER__() {
      return this.___handleTimeZoneSelect__REACT_HOT_LOADER__.apply(this, arguments);
    }
  }, {
    key: '___handleTimeZoneSelect__REACT_HOT_LOADER__',
    value: function ___handleTimeZoneSelect__REACT_HOT_LOADER__(_ref8) {
      var value = _ref8.value;
      return this.setState({ activeTimeZone: value });
    }
  }, {
    key: '___handleApplyClick__REACT_HOT_LOADER__',
    value: function ___handleApplyClick__REACT_HOT_LOADER__() {
      return this.___handleApplyClick__REACT_HOT_LOADER__.apply(this, arguments);
    }
  }, {
    key: '___handleApplyClick__REACT_HOT_LOADER__',
    value: function ___handleApplyClick__REACT_HOT_LOADER__() {
      return this.___handleApplyClick__REACT_HOT_LOADER__.apply(this, arguments);
    }
  }, {
    key: '___handleApplyClick__REACT_HOT_LOADER__',
    value: function ___handleApplyClick__REACT_HOT_LOADER__() {
      var _state = this.state,
          endTime = _state.activeEndTime,
          presetKey = _state.activePreset,
          _state$activeRange2 = (0, _slicedToArray3.default)(_state.activeRange, 2),
          startDate = _state$activeRange2[0],
          endDate = _state$activeRange2[1],
          startTime = _state.activeStartTime,
          timeZone = _state.activeTimeZone;

      this._handleDateChange({
        endDate: endDate,
        endTime: endTime,
        presetKey: presetKey,
        startDate: startDate,
        startTime: startTime,
        timeZone: timeZone
      });
    }
  }, {
    key: '___handleDateChange__REACT_HOT_LOADER__',
    value: function ___handleDateChange__REACT_HOT_LOADER__() {
      return this.___handleDateChange__REACT_HOT_LOADER__.apply(this, arguments);
    }
  }, {
    key: '___handleDateChange__REACT_HOT_LOADER__',
    value: function ___handleDateChange__REACT_HOT_LOADER__() {
      return this.___handleDateChange__REACT_HOT_LOADER__.apply(this, arguments);
    }
  }, {
    key: '___handleDateChange__REACT_HOT_LOADER__',
    value: function ___handleDateChange__REACT_HOT_LOADER__(_ref9) {
      var presetKey = _ref9.presetKey,
          startDate = _ref9.startDate,
          endDate = _ref9.endDate,
          startTime = _ref9.startTime,
          endTime = _ref9.endTime,
          timeZone = _ref9.timeZone;
      var _props = this.props,
          onChange = _props.onChange,
          pattern = _props.pattern;


      onChange({
        endTime: endTime,
        presetKey: presetKey,
        startTime: startTime,
        timeZone: timeZone,
        value: [startDate.format(pattern), endDate.format(pattern)]
      });
      this._closeDropdown();
    }
  }, {
    key: '___toggleDropdown__REACT_HOT_LOADER__',
    value: function ___toggleDropdown__REACT_HOT_LOADER__() {
      return this.___toggleDropdown__REACT_HOT_LOADER__.apply(this, arguments);
    }
  }, {
    key: '___toggleDropdown__REACT_HOT_LOADER__',
    value: function ___toggleDropdown__REACT_HOT_LOADER__() {
      return this.___toggleDropdown__REACT_HOT_LOADER__.apply(this, arguments);
    }
  }, {
    key: '___toggleDropdown__REACT_HOT_LOADER__',
    value: function ___toggleDropdown__REACT_HOT_LOADER__() {
      return this.props.updateDropdown({ open: !this.props.open });
    }
  }, {
    key: '___closeDropdown__REACT_HOT_LOADER__',
    value: function ___closeDropdown__REACT_HOT_LOADER__() {
      return this.___closeDropdown__REACT_HOT_LOADER__.apply(this, arguments);
    }
  }, {
    key: '___closeDropdown__REACT_HOT_LOADER__',
    value: function ___closeDropdown__REACT_HOT_LOADER__() {
      return this.___closeDropdown__REACT_HOT_LOADER__.apply(this, arguments);
    }
  }, {
    key: '___closeDropdown__REACT_HOT_LOADER__',
    value: function ___closeDropdown__REACT_HOT_LOADER__() {
      return this.props.updateDropdown({ open: false });
    }
  }, {
    key: '___openDropdown__REACT_HOT_LOADER__',
    value: function ___openDropdown__REACT_HOT_LOADER__() {
      return this.___openDropdown__REACT_HOT_LOADER__.apply(this, arguments);
    }
  }, {
    key: '___openDropdown__REACT_HOT_LOADER__',
    value: function ___openDropdown__REACT_HOT_LOADER__() {
      return this.___openDropdown__REACT_HOT_LOADER__.apply(this, arguments);
    }
  }, {
    key: '___openDropdown__REACT_HOT_LOADER__',
    value: function ___openDropdown__REACT_HOT_LOADER__() {
      return this.props.updateDropdown({ open: true });
    }
  }, {
    key: '___handleEndTimeClose__REACT_HOT_LOADER__',
    value: function ___handleEndTimeClose__REACT_HOT_LOADER__() {
      return this.___handleEndTimeClose__REACT_HOT_LOADER__.apply(this, arguments);
    }
  }, {
    key: '___handleEndTimeClose__REACT_HOT_LOADER__',
    value: function ___handleEndTimeClose__REACT_HOT_LOADER__() {
      return this.___handleEndTimeClose__REACT_HOT_LOADER__.apply(this, arguments);
    }
  }, {
    key: '___handleEndTimeClose__REACT_HOT_LOADER__',
    value: function ___handleEndTimeClose__REACT_HOT_LOADER__() {
      return this.setState({ endTimeOpen: false });
    }
  }, {
    key: '___handleEndTimeOpen__REACT_HOT_LOADER__',
    value: function ___handleEndTimeOpen__REACT_HOT_LOADER__() {
      return this.___handleEndTimeOpen__REACT_HOT_LOADER__.apply(this, arguments);
    }
  }, {
    key: '___handleEndTimeOpen__REACT_HOT_LOADER__',
    value: function ___handleEndTimeOpen__REACT_HOT_LOADER__() {
      return this.___handleEndTimeOpen__REACT_HOT_LOADER__.apply(this, arguments);
    }
  }, {
    key: '___handleEndTimeOpen__REACT_HOT_LOADER__',
    value: function ___handleEndTimeOpen__REACT_HOT_LOADER__() {
      return this.setState({
        endTimeOpen: true,
        startTimeOpen: false
      });
    }
  }, {
    key: '___handleEndTimeRef__REACT_HOT_LOADER__',
    value: function ___handleEndTimeRef__REACT_HOT_LOADER__() {
      return this.___handleEndTimeRef__REACT_HOT_LOADER__.apply(this, arguments);
    }
  }, {
    key: '___handleEndTimeRef__REACT_HOT_LOADER__',
    value: function ___handleEndTimeRef__REACT_HOT_LOADER__() {
      return this.___handleEndTimeRef__REACT_HOT_LOADER__.apply(this, arguments);
    }
  }, {
    key: '___handleEndTimeRef__REACT_HOT_LOADER__',
    value: function ___handleEndTimeRef__REACT_HOT_LOADER__(ref) {
      this._endTimePicker = ref;
    }
  }, {
    key: '___handleEndTimeSelect__REACT_HOT_LOADER__',
    value: function ___handleEndTimeSelect__REACT_HOT_LOADER__() {
      return this.___handleEndTimeSelect__REACT_HOT_LOADER__.apply(this, arguments);
    }
  }, {
    key: '___handleEndTimeSelect__REACT_HOT_LOADER__',
    value: function ___handleEndTimeSelect__REACT_HOT_LOADER__() {
      return this.___handleEndTimeSelect__REACT_HOT_LOADER__.apply(this, arguments);
    }
  }, {
    key: '___handleEndTimeSelect__REACT_HOT_LOADER__',
    value: function ___handleEndTimeSelect__REACT_HOT_LOADER__(item) {
      var time = _getTimeFromItemSelect(item);
      time && this.setState({ activeEndTime: time });
    }
  }, {
    key: '___handleStartTimeClose__REACT_HOT_LOADER__',
    value: function ___handleStartTimeClose__REACT_HOT_LOADER__() {
      return this.___handleStartTimeClose__REACT_HOT_LOADER__.apply(this, arguments);
    }
  }, {
    key: '___handleStartTimeClose__REACT_HOT_LOADER__',
    value: function ___handleStartTimeClose__REACT_HOT_LOADER__() {
      return this.___handleStartTimeClose__REACT_HOT_LOADER__.apply(this, arguments);
    }
  }, {
    key: '___handleStartTimeClose__REACT_HOT_LOADER__',
    value: function ___handleStartTimeClose__REACT_HOT_LOADER__() {
      return this.setState({ startTimeOpen: false });
    }
  }, {
    key: '___handleStartTimeOpen__REACT_HOT_LOADER__',
    value: function ___handleStartTimeOpen__REACT_HOT_LOADER__() {
      return this.___handleStartTimeOpen__REACT_HOT_LOADER__.apply(this, arguments);
    }
  }, {
    key: '___handleStartTimeOpen__REACT_HOT_LOADER__',
    value: function ___handleStartTimeOpen__REACT_HOT_LOADER__() {
      return this.___handleStartTimeOpen__REACT_HOT_LOADER__.apply(this, arguments);
    }
  }, {
    key: '___handleStartTimeOpen__REACT_HOT_LOADER__',
    value: function ___handleStartTimeOpen__REACT_HOT_LOADER__() {
      return this.setState({
        endTimeOpen: false,
        startTimeOpen: true
      });
    }
  }, {
    key: '___handleStartTimeRef__REACT_HOT_LOADER__',
    value: function ___handleStartTimeRef__REACT_HOT_LOADER__() {
      return this.___handleStartTimeRef__REACT_HOT_LOADER__.apply(this, arguments);
    }
  }, {
    key: '___handleStartTimeRef__REACT_HOT_LOADER__',
    value: function ___handleStartTimeRef__REACT_HOT_LOADER__() {
      return this.___handleStartTimeRef__REACT_HOT_LOADER__.apply(this, arguments);
    }
  }, {
    key: '___handleStartTimeRef__REACT_HOT_LOADER__',
    value: function ___handleStartTimeRef__REACT_HOT_LOADER__(ref) {
      this._startTimePicker = ref;
    }
  }, {
    key: '___handleStartTimeSelect__REACT_HOT_LOADER__',
    value: function ___handleStartTimeSelect__REACT_HOT_LOADER__() {
      return this.___handleStartTimeSelect__REACT_HOT_LOADER__.apply(this, arguments);
    }
  }, {
    key: '___handleStartTimeSelect__REACT_HOT_LOADER__',
    value: function ___handleStartTimeSelect__REACT_HOT_LOADER__() {
      return this.___handleStartTimeSelect__REACT_HOT_LOADER__.apply(this, arguments);
    }
  }, {
    key: '___handleStartTimeSelect__REACT_HOT_LOADER__',
    value: function ___handleStartTimeSelect__REACT_HOT_LOADER__(item) {
      var time = _getTimeFromItemSelect(item);
      time && this.setState({ activeStartTime: time });
    }
  }, {
    key: 'render',
    value: function render() {
      var props = this.props,
          state = this.state;
      var displayPattern = props.displayPattern,
          footerContent = props.footerContent,
          mode = props.mode,
          open = props.open,
          outOfRangeTooltip = props.outOfRangeTooltip,
          rangeEndBoundary = props.rangeEndBoundary,
          rangeStartBoundary = props.rangeStartBoundary,
          secondaryText = props.secondaryText,
          value = props.value,
          onChange = props.onChange;

      var activeEndTime = state.activeEndTime,
          activePreset = state.activePreset,
          activeRange = state.activeRange,
          _state$activeRange3 = (0, _slicedToArray3.default)(state.activeRange, 2),
          activeStartDate = _state$activeRange3[0],
          activeEndDate = _state$activeRange3[1],
          activeStartTime = state.activeStartTime,
          activeTimeZone = state.activeTimeZone,
          endTimeOpen = state.endTimeOpen,
          startTimeOpen = state.startTimeOpen;

      // TimePicker boundaries have to update with range selection


      var _buildTimeBoundaries = buildTimeBoundaries({
        endDate: activeEndDate,
        rangeEndBoundary: rangeEndBoundary,
        rangeStartBoundary: rangeStartBoundary,
        startDate: activeStartDate
      }),
          endTimeBoundaryEnd = _buildTimeBoundaries.endTimeBoundaryEnd,
          endTimeBoundaryStart = _buildTimeBoundaries.endTimeBoundaryStart,
          startTimeBoundaryEnd = _buildTimeBoundaries.startTimeBoundaryEnd,
          startTimeBoundaryStart = _buildTimeBoundaries.startTimeBoundaryStart;

      var displayValue = buildDisplayValueFromDates(value[0], value[1], displayPattern);
      var showTimeAndFooter = mode !== 'simple';
      var startTimeTextValue = _formatTime(activeStartTime);
      var endTimeTextValue = _formatTime(activeEndTime);

      // only enable button when new date has been selected and values are in range
      var applyButtonIsDisabled = isApplyButtonDisabled(props, state);

      var dropdownIcon = _react2.default.createElement(_IconButton2.default, {
        icon: _CalendarOutline2.default,
        onClick: this._toggleDropdown,
        variant: 'plain'
      });

      return _react2.default.createElement(
        'div',
        {
          'data-component': 'TxlDateRangeSelector',
          style: _DateRangeSelector.WRAPPER_STYLE
        },
        _react2.default.createElement(_TextField2.default, {
          _afterContent: dropdownIcon
          // onClick/onChange aren't explicit TextField props;
          // they're passed to input elem via 'otherProps'
          , onChange: onChange,
          onClick: this._openDropdown,
          readOnly: true,
          ref: 'textField',
          secondaryText: secondaryText,
          type: 'text',
          value: displayValue
        }),
        _react2.default.createElement(_InputUnderline2.default, { validationState: 'base' }),
        _react2.default.createElement(
          _DropdownContent2.default,
          {
            style: _DateRangeSelector.DROPDOWN_CONTAINER_STYLE,
            onMouseDown: this._disableBlur,
            onClick: this._enableBlur,
            open: open
          },
          _react2.default.createElement(_CalendarPickerWithPresets2.default, {
            onDateSelect: this._handleDateSelect,
            outOfRangeTooltip: outOfRangeTooltip,
            presetKey: activePreset,
            range: activeRange,
            rangeEndBoundary: rangeEndBoundary,
            rangeStartBoundary: rangeStartBoundary,
            ref: 'calPicker'
          }),
          showTimeAndFooter && _react2.default.createElement(
            'section',
            null,
            _react2.default.createElement(
              'div',
              { style: _DateRangeSelector.TIME_WRAPPER_STYLE },
              _react2.default.createElement(
                'div',
                { style: _DateRangeSelector.TIME_ZONE_WRAPPER_STYLE },
                _react2.default.createElement(_TimeZonePicker2.default, {
                  label: TIME_ZONE_PICKER_LABEL,
                  onItemSelect: this._handleTimeZoneSelect,
                  ref: 'timeZonePicker',
                  value: activeTimeZone
                })
              ),
              _react2.default.createElement(
                'div',
                null,
                _react2.default.createElement(
                  'div',
                  { style: _DateRangeSelector.LABEL_STYLE },
                  TIME_RANGE_PICKER_LABEL
                ),
                _react2.default.createElement(
                  'div',
                  { style: _DateRangeSelector.TIME_RANGE_WRAPPER_STYLE },
                  _react2.default.createElement(
                    'div',
                    { style: _DateRangeSelector.TIME_PICKER_WRAPPER_STYLE },
                    _react2.default.createElement(_TimePickerControlled2.default, {
                      boundaryEnd: startTimeBoundaryEnd,
                      boundaryStart: startTimeBoundaryStart,
                      closeDropdown: this._handleStartTimeClose,
                      onItemSelect: this._handleStartTimeSelect,
                      open: startTimeOpen,
                      openDropdown: this._handleStartTimeOpen,
                      pattern: TIME_PATTERN,
                      ref: this._handleStartTimeRef,
                      secondaryText: buildTimeRangeSecondaryText(activeStartDate),
                      textValue: startTimeTextValue,
                      time: activeStartTime
                    })
                  ),
                  _react2.default.createElement(
                    'div',
                    { style: _DateRangeSelector.INPUT_SEPARATOR_STYLE },
                    TIME_DELIMITER_TEXT
                  ),
                  _react2.default.createElement(
                    'div',
                    { style: _DateRangeSelector.TIME_PICKER_WRAPPER_STYLE },
                    _react2.default.createElement(_TimePickerControlled2.default, {
                      boundaryEnd: endTimeBoundaryEnd,
                      boundaryStart: endTimeBoundaryStart,
                      closeDropdown: this._handleEndTimeClose,
                      onItemSelect: this._handleEndTimeSelect,
                      open: endTimeOpen,
                      openDropdown: this._handleEndTimeOpen,
                      pattern: TIME_PATTERN,
                      ref: this._handleEndTimeRef,
                      secondaryText: buildTimeRangeSecondaryText(activeEndDate),
                      textValue: endTimeTextValue,
                      time: activeEndTime
                    })
                  )
                )
              )
            ),
            _react2.default.createElement(
              'footer',
              { style: _DateRangeSelector.FOOTER_STYLE },
              _react2.default.createElement(
                'div',
                { style: _DateRangeSelector.BUTTON_GROUP_STYLE },
                _react2.default.createElement(
                  _Button2.default,
                  {
                    _style: _DateRangeSelector.BUTTON_STYLE,
                    disabled: applyButtonIsDisabled,
                    onClick: this._handleApplyClick,
                    ref: 'applyButton',
                    size: 'large',
                    variant: 'accent'
                  },
                  APPLY_BUTTON_TEXT
                ),
                _react2.default.createElement(
                  _Button2.default,
                  {
                    _style: _DateRangeSelector.BUTTON_STYLE,
                    onClick: this._closeDropdown,
                    ref: 'cancelButton',
                    size: 'large',
                    variant: 'muted'
                  },
                  CANCEL_BUTTON_TEXT
                )
              ),
              footerContent && _react2.default.createElement(
                'div',
                { style: _DateRangeSelector.FOOTER_CONTENT_STYLE },
                footerContent
              )
            )
          )
        )
      );
    }
  }]);
  return TxlDateRangeSelector;
}(_react2.default.Component)) || _class;

exports.default = TxlDateRangeSelector;


TxlDateRangeSelector.propTypes = {
  displayPattern: _react.PropTypes.string,
  endTime: _TimePickerControlled2.default.propTypes.time,
  footerContent: _react.PropTypes.node,
  mode: _react.PropTypes.oneOf(['simple', 'full']),
  onChange: _react.PropTypes.func.isRequired,
  open: _react.PropTypes.bool,
  outOfRangeTooltip: _CalendarPickerWithPresets2.default.propTypes.outOfRangeTooltip,
  pattern: _react.PropTypes.string,
  presetKey: _CalendarPickerWithPresets2.default.propTypes.presetKey,
  rangeEndBoundary: _CalendarPickerWithPresets2.default.propTypes.rangeEndBoundary,
  rangeStartBoundary: _CalendarPickerWithPresets2.default.propTypes.rangeStartBoundary,
  secondaryText: _react.PropTypes.node,
  startTime: _TimePickerControlled2.default.propTypes.time,
  timeZone: _TimeZonePicker2.default.propTypes.value,
  updateDropdown: _react.PropTypes.func,
  value: _propTypes2.default.dateRange
};

TxlDateRangeSelector.defaultProps = {
  displayPattern: CONDENSED_DATE_FORMAT,
  endTime: (0, _CalendarUtils.timeObjFromMoment)(todayPreset.endDate),
  mode: 'full',
  open: false,
  pattern: DEFAULT_DATE_INPUT_PATTERN,
  presetKey: 'today',
  startTime: (0, _CalendarUtils.timeObjFromMoment)(todayPreset.startDate),
  timeZone: _moment2.default.tz.guess(),
  updateDropdown: _Base.NOOP,
  value: [todayPreset.startDate, todayPreset.endDate]
};
;

var _temp = function () {
  if (typeof __REACT_HOT_LOADER__ === 'undefined') {
    return;
  }

  __REACT_HOT_LOADER__.register(todayPreset, 'todayPreset', 'src/input-fields/_ControlledDateRangeSelector.jsx');

  __REACT_HOT_LOADER__.register(DEFAULT_DATE_INPUT_PATTERN, 'DEFAULT_DATE_INPUT_PATTERN', 'src/input-fields/_ControlledDateRangeSelector.jsx');

  __REACT_HOT_LOADER__.register(CONDENSED_DATE_FORMAT, 'CONDENSED_DATE_FORMAT', 'src/input-fields/_ControlledDateRangeSelector.jsx');

  __REACT_HOT_LOADER__.register(TIME_PATTERN, 'TIME_PATTERN', 'src/input-fields/_ControlledDateRangeSelector.jsx');

  __REACT_HOT_LOADER__.register(APPLY_BUTTON_TEXT, 'APPLY_BUTTON_TEXT', 'src/input-fields/_ControlledDateRangeSelector.jsx');

  __REACT_HOT_LOADER__.register(CANCEL_BUTTON_TEXT, 'CANCEL_BUTTON_TEXT', 'src/input-fields/_ControlledDateRangeSelector.jsx');

  __REACT_HOT_LOADER__.register(TIME_RANGE_PICKER_LABEL, 'TIME_RANGE_PICKER_LABEL', 'src/input-fields/_ControlledDateRangeSelector.jsx');

  __REACT_HOT_LOADER__.register(TIME_ZONE_PICKER_LABEL, 'TIME_ZONE_PICKER_LABEL', 'src/input-fields/_ControlledDateRangeSelector.jsx');

  __REACT_HOT_LOADER__.register(TIME_DELIMITER_TEXT, 'TIME_DELIMITER_TEXT', 'src/input-fields/_ControlledDateRangeSelector.jsx');

  __REACT_HOT_LOADER__.register(_mapStringToTime, '_mapStringToTime', 'src/input-fields/_ControlledDateRangeSelector.jsx');

  __REACT_HOT_LOADER__.register(_getTimeFromItemSelect, '_getTimeFromItemSelect', 'src/input-fields/_ControlledDateRangeSelector.jsx');

  __REACT_HOT_LOADER__.register(_formatTime, '_formatTime', 'src/input-fields/_ControlledDateRangeSelector.jsx');

  __REACT_HOT_LOADER__.register(hasDateRangeChanged, 'hasDateRangeChanged', 'src/input-fields/_ControlledDateRangeSelector.jsx');

  __REACT_HOT_LOADER__.register(hasTimeRangeChanged, 'hasTimeRangeChanged', 'src/input-fields/_ControlledDateRangeSelector.jsx');

  __REACT_HOT_LOADER__.register(hasNewSelectedValue, 'hasNewSelectedValue', 'src/input-fields/_ControlledDateRangeSelector.jsx');

  __REACT_HOT_LOADER__.register(buildDisplayValueFromDates, 'buildDisplayValueFromDates', 'src/input-fields/_ControlledDateRangeSelector.jsx');

  __REACT_HOT_LOADER__.register(buildTimeRangeSecondaryText, 'buildTimeRangeSecondaryText', 'src/input-fields/_ControlledDateRangeSelector.jsx');

  __REACT_HOT_LOADER__.register(areDatesInRange, 'areDatesInRange', 'src/input-fields/_ControlledDateRangeSelector.jsx');

  __REACT_HOT_LOADER__.register(isApplyButtonDisabled, 'isApplyButtonDisabled', 'src/input-fields/_ControlledDateRangeSelector.jsx');

  __REACT_HOT_LOADER__.register(buildTimeBoundaries, 'buildTimeBoundaries', 'src/input-fields/_ControlledDateRangeSelector.jsx');

  __REACT_HOT_LOADER__.register(TxlDateRangeSelector, 'TxlDateRangeSelector', 'src/input-fields/_ControlledDateRangeSelector.jsx');
}();

;
module.exports = exports['default'];
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9pbnB1dC1maWVsZHMvX0NvbnRyb2xsZWREYXRlUmFuZ2VTZWxlY3Rvci5qc3giXSwibmFtZXMiOlsiZmlsdGVyIiwicHJlc2V0Iiwia2V5IiwidG9kYXlQcmVzZXQiLCJERUZBVUxUX0RBVEVfSU5QVVRfUEFUVEVSTiIsIkNPTkRFTlNFRF9EQVRFX0ZPUk1BVCIsIlRJTUVfUEFUVEVSTiIsIkFQUExZX0JVVFRPTl9URVhUIiwiQ0FOQ0VMX0JVVFRPTl9URVhUIiwiVElNRV9SQU5HRV9QSUNLRVJfTEFCRUwiLCJUSU1FX1pPTkVfUElDS0VSX0xBQkVMIiwiVElNRV9ERUxJTUlURVJfVEVYVCIsIl9tYXBTdHJpbmdUb1RpbWUiLCJ0aW1lU3RyIiwidGltZU1vbWVudCIsImlzVmFsaWQiLCJfZ2V0VGltZUZyb21JdGVtU2VsZWN0IiwiaG91ciIsIm1pbnV0ZSIsInNlY29uZCIsInZhbHVlIiwiX2Zvcm1hdFRpbWUiLCJ0aW1lT2JqIiwiZm9ybWF0IiwiaGFzRGF0ZVJhbmdlQ2hhbmdlZCIsImV4aXN0aW5nUmFuZ2UiLCJhY3RpdmVSYW5nZSIsImV4aXN0aW5nU3RhcnQiLCJleGlzdGluZ0VuZCIsImFjdGl2ZVN0YXJ0IiwiYWN0aXZlRW5kIiwiaXNTYW1lIiwiaGFzVGltZVJhbmdlQ2hhbmdlZCIsInN0YXJ0VGltZSIsImVuZFRpbWUiLCJhY3RpdmVTdGFydFRpbWUiLCJhY3RpdmVFbmRUaW1lIiwiaGFzTmV3U2VsZWN0ZWRWYWx1ZSIsInByb3BzIiwic3RhdGUiLCJ0aW1lWm9uZSIsImFjdGl2ZVRpbWVab25lIiwibWFwIiwiYnVpbGREaXNwbGF5VmFsdWVGcm9tRGF0ZXMiLCJzdGFydERhdGUiLCJlbmREYXRlIiwicGF0dGVybiIsImlzVmFsaWRSYW5nZSIsImRhdGUiLCJqb2luIiwiYnVpbGRUaW1lUmFuZ2VTZWNvbmRhcnlUZXh0IiwiZGF0ZVN0cmluZyIsImFyZURhdGVzSW5SYW5nZSIsInN0YXJ0IiwiZW5kIiwicmFuZ2VFbmRCb3VuZGFyeSIsInJhbmdlU3RhcnRCb3VuZGFyeSIsImlzQXBwbHlCdXR0b25EaXNhYmxlZCIsImFjdGl2ZVN0YXJ0RGF0ZSIsImFjdGl2ZUVuZERhdGUiLCJjbG9uZSIsInNldCIsImJ1aWxkVGltZUJvdW5kYXJpZXMiLCJib3VuZGFyaWVzIiwiZW5kVGltZUJvdW5kYXJ5RW5kIiwiZW5kT2YiLCJlbmRUaW1lQm91bmRhcnlTdGFydCIsInN0YXJ0T2YiLCJzdGFydFRpbWVCb3VuZGFyeUVuZCIsInN0YXJ0VGltZUJvdW5kYXJ5U3RhcnQiLCJUeGxEYXRlUmFuZ2VTZWxlY3RvciIsImFyZ3MiLCJfaGFuZGxlRGF0ZVNlbGVjdCIsIl9oYW5kbGVUaW1lWm9uZVNlbGVjdCIsIl9oYW5kbGVBcHBseUNsaWNrIiwiX2hhbmRsZURhdGVDaGFuZ2UiLCJfdG9nZ2xlRHJvcGRvd24iLCJfY2xvc2VEcm9wZG93biIsIl9vcGVuRHJvcGRvd24iLCJfaGFuZGxlRW5kVGltZUNsb3NlIiwiX2hhbmRsZUVuZFRpbWVPcGVuIiwiX2hhbmRsZUVuZFRpbWVSZWYiLCJfaGFuZGxlRW5kVGltZVNlbGVjdCIsIl9oYW5kbGVTdGFydFRpbWVDbG9zZSIsIl9oYW5kbGVTdGFydFRpbWVPcGVuIiwiX2hhbmRsZVN0YXJ0VGltZVJlZiIsIl9oYW5kbGVTdGFydFRpbWVTZWxlY3QiLCJwcmVzZXRLZXkiLCJhY3RpdmVQcmVzZXQiLCJlbmRUaW1lT3BlbiIsInN0YXJ0VGltZU9wZW4iLCJ0aW1lQm91bmRhcmllcyIsIm5leHRQcm9wcyIsInNldFN0YXRlIiwibmV3RGF0ZVN0YXRlIiwibW9kZSIsIm9uQ2hhbmdlIiwidXBkYXRlRHJvcGRvd24iLCJvcGVuIiwicmVmIiwiX2VuZFRpbWVQaWNrZXIiLCJpdGVtIiwidGltZSIsIl9zdGFydFRpbWVQaWNrZXIiLCJkaXNwbGF5UGF0dGVybiIsImZvb3RlckNvbnRlbnQiLCJvdXRPZlJhbmdlVG9vbHRpcCIsInNlY29uZGFyeVRleHQiLCJkaXNwbGF5VmFsdWUiLCJzaG93VGltZUFuZEZvb3RlciIsInN0YXJ0VGltZVRleHRWYWx1ZSIsImVuZFRpbWVUZXh0VmFsdWUiLCJhcHBseUJ1dHRvbklzRGlzYWJsZWQiLCJkcm9wZG93bkljb24iLCJfZGlzYWJsZUJsdXIiLCJfZW5hYmxlQmx1ciIsIkNvbXBvbmVudCIsInByb3BUeXBlcyIsInN0cmluZyIsIm5vZGUiLCJvbmVPZiIsImZ1bmMiLCJpc1JlcXVpcmVkIiwiYm9vbCIsImRhdGVSYW5nZSIsImRlZmF1bHRQcm9wcyIsInR6IiwiZ3Vlc3MiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTs7OztBQUNBOzs7O0FBQ0E7Ozs7QUFDQTs7OztBQUVBOztBQUNBOztBQU9BOzs7O0FBQ0E7Ozs7QUFDQTs7OztBQUNBOzs7O0FBQ0E7Ozs7QUFDQTs7OztBQUNBOzs7O0FBQ0E7Ozs7QUFDQTs7OztBQUNBOzs7O0FBQ0E7Ozs7NEJBZXNCLGtDQUFtQkEsTUFBbkIsQ0FBMEI7QUFBQSxTQUFVQyxPQUFPQyxHQUFQLEtBQWUsT0FBekI7QUFBQSxDQUExQixDOztJQUFmQyxXOztBQUVQLElBQU1DLDZCQUE2QixZQUFuQztBQUNBLElBQU1DLHdCQUF3QixhQUE5QjtBQUNBLElBQU1DLGVBQWUsWUFBckI7O0FBRUE7QUFDQSxJQUFNQyxvQkFBb0IsT0FBMUI7QUFDQSxJQUFNQyxxQkFBcUIsUUFBM0I7QUFDQSxJQUFNQywwQkFBMEIsWUFBaEM7QUFDQSxJQUFNQyx5QkFBeUIsV0FBL0I7QUFDQSxJQUFNQyxzQkFBc0IsSUFBNUI7O0FBRUE7QUFDQSxJQUFNQyxtQkFBbUIsU0FBbkJBLGdCQUFtQixDQUFDQyxPQUFELEVBQWE7QUFDcEMsTUFBTUMsYUFBYSxzQkFBT0QsT0FBUCxFQUFnQlAsWUFBaEIsRUFBOEIsSUFBOUIsQ0FBbkI7QUFDQSxTQUFPUSxXQUFXQyxPQUFYLEtBQXVCLHNDQUFrQkQsVUFBbEIsQ0FBdkIsR0FBdUQsSUFBOUQ7QUFDRCxDQUhEOztBQUtBO0FBQ0EsSUFBTUUseUJBQXlCLFNBQXpC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OEQsU0FBMUIsQ0FBb0M5RCxnQkFWdkI7QUFXL0JDLHNCQUFvQixvQ0FBMEI2RCxTQUExQixDQUFvQzdELGtCQVh6QjtBQVkvQm1ELGlCQUFlLGlCQUFVWSxJQVpNO0FBYS9CdEYsYUFBVywrQkFBcUJvRixTQUFyQixDQUErQmYsSUFiWDtBQWMvQjlELFlBQVUseUJBQWU2RSxTQUFmLENBQXlCakcsS0FkSjtBQWUvQjZFLGtCQUFnQixpQkFBVXdCLElBZks7QUFnQi9CckcsU0FBTyxvQkFBYXdHO0FBaEJXLENBQWpDOztBQW1CQXRELHFCQUFxQnVELFlBQXJCLEdBQW9DO0FBQ2xDckIsa0JBQWdCbkcscUJBRGtCO0FBRWxDNkIsV0FBUyxzQ0FBa0IvQixZQUFZMEMsT0FBOUIsQ0FGeUI7QUFHbENrRCxRQUFNLE1BSDRCO0FBSWxDRyxRQUFNLEtBSjRCO0FBS2xDcEQsV0FBUzFDLDBCQUx5QjtBQU1sQ21GLGFBQVcsT0FOdUI7QUFPbEN0RCxhQUFXLHNDQUFrQjlCLFlBQVl5QyxTQUE5QixDQVB1QjtBQVFsQ0osWUFBVSxpQkFBT3NGLEVBQVAsQ0FBVUMsS0FBVixFQVJ3QjtBQVNsQzlCLDRCQVRrQztBQVVsQzdFLFNBQU8sQ0FBQ2pCLFlBQVl5QyxTQUFiLEVBQXdCekMsWUFBWTBDLE9BQXBDO0FBVjJCLENBQXBDOzs7Ozs7OztnQ0F6ZE8xQyxXOztnQ0FFREMsMEI7O2dDQUNBQyxxQjs7Z0NBQ0FDLFk7O2dDQUdBQyxpQjs7Z0NBQ0FDLGtCOztnQ0FDQUMsdUI7O2dDQUNBQyxzQjs7Z0NBQ0FDLG1COztnQ0FHQUMsZ0I7O2dDQU1BSSxzQjs7Z0NBSUFLLFc7O2dDQUlHRyxtQjs7Z0NBT0FRLG1COztnQ0FJQUssbUI7O2dDQVNBTSwwQjs7Z0NBT0FPLDJCOztnQ0FJQUUsZTs7Z0NBS0FLLHFCOztnQ0E0QkFLLG1COztnQ0FrQ1lRLG9CIiwiZmlsZSI6Il9Db250cm9sbGVkRGF0ZVJhbmdlU2VsZWN0b3IuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgUmVhY3QsIHsgUHJvcFR5cGVzIH0gZnJvbSAncmVhY3QnO1xuaW1wb3J0IFJhZGl1bSBmcm9tICdyYWRpdW0nO1xuaW1wb3J0IG1vbWVudCBmcm9tICdtb21lbnQnO1xuaW1wb3J0IGlzRXF1YWwgZnJvbSAnbG9kYXNoL2lzRXF1YWwnO1xuXG5pbXBvcnQgeyBOT09QIH0gZnJvbSAnLi4vYmFzZS9CYXNlJztcbmltcG9ydCB7XG4gIERBVEVfUkFOR0VfUFJFU0VUUyxcbiAgZGF0ZVN0cmluZ1RvTW9tZW50LFxuICBpc0RhdGVXaXRoaW5SYW5nZSxcbiAgaXNWYWxpZERhdGVSYW5nZSxcbiAgdGltZU9iakZyb21Nb21lbnQsXG59IGZyb20gJy4uL2NhbGVuZGFyLXBpY2tlci9fQ2FsZW5kYXJVdGlscyc7XG5pbXBvcnQgVHhsUHJvcFR5cGVzIGZyb20gJy4uL3V0aWxzL3Byb3BUeXBlcyc7XG5pbXBvcnQgQnV0dG9uIGZyb20gJy4uL2J1dHRvbnMvQnV0dG9uJztcbmltcG9ydCBDYWxlbmRhckljb24gZnJvbSAnLi4vaWNvbnMvQ2FsZW5kYXJPdXRsaW5lJztcbmltcG9ydCBDYWxlbmRhclBpY2tlcldpdGhQcmVzZXRzIGZyb20gJy4uL2NhbGVuZGFyLXBpY2tlci9DYWxlbmRhclBpY2tlcldpdGhQcmVzZXRzJztcbmltcG9ydCBEcm9wZG93bkNvbnRlbnQgZnJvbSAnLi4vZHJvcGRvd25zL19Ecm9wZG93bkNvbnRlbnQnO1xuaW1wb3J0IEljb25CdXR0b24gZnJvbSAnLi4vYnV0dG9ucy9JY29uQnV0dG9uJztcbmltcG9ydCBJbnB1dFVuZGVybGluZSBmcm9tICcuLi9sYXlvdXQvX0lucHV0VW5kZXJsaW5lJztcbmltcG9ydCBUZXh0RmllbGQgZnJvbSAnLi4vaW5wdXQtZmllbGRzL1RleHRGaWVsZCc7XG5pbXBvcnQgVGltZVpvbmVQaWNrZXIgZnJvbSAnLi4vaW5wdXQtZmllbGRzL19UaW1lWm9uZVBpY2tlcic7XG5pbXBvcnQgVGltZVBpY2tlckNvbnRyb2xsZWQgZnJvbSAnLi4vaW5wdXQtZmllbGRzL1RpbWVQaWNrZXJDb250cm9sbGVkJztcbmltcG9ydCB7XG4gIEJVVFRPTl9HUk9VUF9TVFlMRSxcbiAgQlVUVE9OX1NUWUxFLFxuICBEUk9QRE9XTl9DT05UQUlORVJfU1RZTEUsXG4gIEZPT1RFUl9DT05URU5UX1NUWUxFLFxuICBGT09URVJfU1RZTEUsXG4gIElOUFVUX1NFUEFSQVRPUl9TVFlMRSxcbiAgTEFCRUxfU1RZTEUsXG4gIFRJTUVfUElDS0VSX1dSQVBQRVJfU1RZTEUsXG4gIFRJTUVfUkFOR0VfV1JBUFBFUl9TVFlMRSxcbiAgVElNRV9XUkFQUEVSX1NUWUxFLFxuICBUSU1FX1pPTkVfV1JBUFBFUl9TVFlMRSxcbiAgV1JBUFBFUl9TVFlMRSxcbn0gZnJvbSAnLi9EYXRlUmFuZ2VTZWxlY3Rvci5zdHlsZSc7XG5cbmNvbnN0IFt0b2RheVByZXNldF0gPSBEQVRFX1JBTkdFX1BSRVNFVFMuZmlsdGVyKHByZXNldCA9PiBwcmVzZXQua2V5ID09PSAndG9kYXknKTtcblxuY29uc3QgREVGQVVMVF9EQVRFX0lOUFVUX1BBVFRFUk4gPSAnWVlZWS1NTS1ERCc7XG5jb25zdCBDT05ERU5TRURfREFURV9GT1JNQVQgPSAnTU1NIEQsIFlZWVknO1xuY29uc3QgVElNRV9QQVRURVJOID0gJ2hoOm1tOnNzIEEnO1xuXG4vLyBAVE9ETyB0cmFuc2xhdGVcbmNvbnN0IEFQUExZX0JVVFRPTl9URVhUID0gJ0FwcGx5JztcbmNvbnN0IENBTkNFTF9CVVRUT05fVEVYVCA9ICdDYW5jZWwnO1xuY29uc3QgVElNRV9SQU5HRV9QSUNLRVJfTEFCRUwgPSAnVGltZSByYW5nZSc7XG5jb25zdCBUSU1FX1pPTkVfUElDS0VSX0xBQkVMID0gJ1RpbWUgem9uZSc7XG5jb25zdCBUSU1FX0RFTElNSVRFUl9URVhUID0gJ3RvJztcblxuLy8gQ29udmVydCB0aW1lIHN0cmluZyB0aGF0IG1hdGNoZXMgcGF0dGVybiB0byB7IGhvdXIsIG1pbnV0ZSwgc2Vjb25kIH0gb2JqXG5jb25zdCBfbWFwU3RyaW5nVG9UaW1lID0gKHRpbWVTdHIpID0+IHtcbiAgY29uc3QgdGltZU1vbWVudCA9IG1vbWVudCh0aW1lU3RyLCBUSU1FX1BBVFRFUk4sIHRydWUpO1xuICByZXR1cm4gdGltZU1vbWVudC5pc1ZhbGlkKCkgPyB0aW1lT2JqRnJvbU1vbWVudCh0aW1lTW9tZW50KSA6IG51bGw7XG59O1xuXG4vLyB2YWx1ZSBwcm9wIGNvbWVzIHRocm91Z2ggZnJvbSBcIkNyZWF0ZSBOZXdcIiwgbS9oL3Mgb2JqIGNvbWVzIGZyb20gaXRlbSBzZWxlY3QgaGFuZGxlclxuY29uc3QgX2dldFRpbWVGcm9tSXRlbVNlbGVjdCA9ICh7IGhvdXIsIG1pbnV0ZSwgc2Vjb25kLCB2YWx1ZSB9KSA9PiAoXG4gIHZhbHVlID8gX21hcFN0cmluZ1RvVGltZSh2YWx1ZSkgOiB7IGhvdXIsIG1pbnV0ZSwgc2Vjb25kIH1cbik7XG5cbmNvbnN0IF9mb3JtYXRUaW1lID0gdGltZU9iaiA9PiAoXG4gIHRpbWVPYmogIT09IG51bGwgPyBtb21lbnQodGltZU9iaikuZm9ybWF0KFRJTUVfUEFUVEVSTikgOiAnJ1xuKTtcblxuZnVuY3Rpb24gaGFzRGF0ZVJhbmdlQ2hhbmdlZChleGlzdGluZ1JhbmdlLCBhY3RpdmVSYW5nZSkge1xuICBjb25zdCBbZXhpc3RpbmdTdGFydCwgZXhpc3RpbmdFbmRdID0gZXhpc3RpbmdSYW5nZTtcbiAgY29uc3QgW2FjdGl2ZVN0YXJ0LCBhY3RpdmVFbmRdID0gYWN0aXZlUmFuZ2U7XG4gIHJldHVybiBleGlzdGluZ1N0YXJ0ICYmIGV4aXN0aW5nRW5kXG4gICAgJiYgKCFleGlzdGluZ1N0YXJ0LmlzU2FtZShhY3RpdmVTdGFydCwgJ2RheScpIHx8ICFleGlzdGluZ0VuZC5pc1NhbWUoYWN0aXZlRW5kLCAnZGF5JykpO1xufVxuXG5mdW5jdGlvbiBoYXNUaW1lUmFuZ2VDaGFuZ2VkKHsgc3RhcnRUaW1lLCBlbmRUaW1lIH0sIHsgYWN0aXZlU3RhcnRUaW1lLCBhY3RpdmVFbmRUaW1lIH0pIHtcbiAgcmV0dXJuICFpc0VxdWFsKHN0YXJ0VGltZSwgYWN0aXZlU3RhcnRUaW1lKSB8fCAhaXNFcXVhbChlbmRUaW1lLCBhY3RpdmVFbmRUaW1lKTtcbn1cblxuZnVuY3Rpb24gaGFzTmV3U2VsZWN0ZWRWYWx1ZShwcm9wcywgc3RhdGUpIHtcbiAgY29uc3QgeyB0aW1lWm9uZSwgdmFsdWUgfSA9IHByb3BzO1xuICBjb25zdCB7IGFjdGl2ZVJhbmdlLCBhY3RpdmVUaW1lWm9uZSB9ID0gc3RhdGU7XG5cbiAgcmV0dXJuIGhhc0RhdGVSYW5nZUNoYW5nZWQodmFsdWUubWFwKGRhdGVTdHJpbmdUb01vbWVudCksIGFjdGl2ZVJhbmdlKVxuICAgIHx8IGhhc1RpbWVSYW5nZUNoYW5nZWQocHJvcHMsIHN0YXRlKVxuICAgIHx8IHRpbWVab25lICE9PSBhY3RpdmVUaW1lWm9uZTtcbn1cblxuZnVuY3Rpb24gYnVpbGREaXNwbGF5VmFsdWVGcm9tRGF0ZXMoc3RhcnREYXRlLCBlbmREYXRlLCBwYXR0ZXJuKSB7XG4gIGNvbnN0IGlzVmFsaWRSYW5nZSA9IHN0YXJ0RGF0ZSAmJiBlbmREYXRlICYmIGlzVmFsaWREYXRlUmFuZ2Uoc3RhcnREYXRlLCBlbmREYXRlKTtcbiAgcmV0dXJuIGlzVmFsaWRSYW5nZVxuICAgID8gW3N0YXJ0RGF0ZSwgZW5kRGF0ZV0ubWFwKGRhdGUgPT4gbW9tZW50KGRhdGUpLmZvcm1hdChwYXR0ZXJuKSkuam9pbignIC0gJylcbiAgICA6ICcnO1xufVxuXG5mdW5jdGlvbiBidWlsZFRpbWVSYW5nZVNlY29uZGFyeVRleHQoZGF0ZVN0cmluZykge1xuICByZXR1cm4gZGF0ZVN0cmluZyA/IG1vbWVudChkYXRlU3RyaW5nKS5mb3JtYXQoQ09OREVOU0VEX0RBVEVfRk9STUFUKSA6ICcnO1xufVxuXG5mdW5jdGlvbiBhcmVEYXRlc0luUmFuZ2UoeyBzdGFydCwgZW5kLCByYW5nZUVuZEJvdW5kYXJ5LCByYW5nZVN0YXJ0Qm91bmRhcnkgfSkge1xuICByZXR1cm4gaXNEYXRlV2l0aGluUmFuZ2Uoc3RhcnQsIHJhbmdlU3RhcnRCb3VuZGFyeSwgcmFuZ2VFbmRCb3VuZGFyeSwgdHJ1ZSlcbiAgICAmJiBpc0RhdGVXaXRoaW5SYW5nZShlbmQsIHJhbmdlU3RhcnRCb3VuZGFyeSwgcmFuZ2VFbmRCb3VuZGFyeSwgdHJ1ZSk7XG59XG5cbmZ1bmN0aW9uIGlzQXBwbHlCdXR0b25EaXNhYmxlZChwcm9wcywgc3RhdGUpIHtcbiAgY29uc3QgeyByYW5nZUVuZEJvdW5kYXJ5LCByYW5nZVN0YXJ0Qm91bmRhcnkgfSA9IHByb3BzO1xuICBjb25zdCB7XG4gICAgYWN0aXZlRW5kVGltZSxcbiAgICBhY3RpdmVTdGFydFRpbWUsXG4gICAgYWN0aXZlUmFuZ2U6IFtcbiAgICAgIGFjdGl2ZVN0YXJ0RGF0ZSxcbiAgICAgIGFjdGl2ZUVuZERhdGUsXG4gICAgXSxcbiAgfSA9IHN0YXRlO1xuXG4gIC8vIG5vIG5ldyB2YWx1ZSwgYnV0dG9uIHN0aWxsIGRpc2FibGVkXG4gIGlmICghaGFzTmV3U2VsZWN0ZWRWYWx1ZShwcm9wcywgc3RhdGUpKSB7IHJldHVybiB0cnVlOyB9XG5cbiAgLy8gbmV3IHZhbHVlIHdpdGggbm8gYm91bmRhcmllcywgYnV0dG9uIGVuYWJsZWRcbiAgaWYgKCFyYW5nZUVuZEJvdW5kYXJ5IHx8ICFyYW5nZVN0YXJ0Qm91bmRhcnkpIHsgcmV0dXJuIGZhbHNlOyB9XG5cbiAgLy8gbmV3IHZhbHVlIHdpdGggYm91bmRhcmllcyBwcm92aWRlZCwgY2hlY2sgdGhhdCBkYXRlIGZhbGxzIGluIHJhbmdlXG4gIHJldHVybiAhYXJlRGF0ZXNJblJhbmdlKHtcbiAgICBlbmQ6IGFjdGl2ZUVuZERhdGUuY2xvbmUoKS5zZXQoYWN0aXZlRW5kVGltZSksXG4gICAgcmFuZ2VFbmRCb3VuZGFyeSxcbiAgICByYW5nZVN0YXJ0Qm91bmRhcnksXG4gICAgc3RhcnQ6IGFjdGl2ZVN0YXJ0RGF0ZS5jbG9uZSgpLnNldChhY3RpdmVTdGFydFRpbWUpLFxuICB9KTtcbn1cblxuLy8gQXMgZGF0ZSByYW5nZSBzZWxlY3Rpb24gY2hhbmdlcywgd2UgbmVlZCB0byB1cGRhdGUgdGhlIGJvdW5kYXJpZXMgdGhhdCB3ZSBzZW5kIHRvIGVhY2hcbi8vIFRpbWVQaWNrZXIgZm9yIHZhbGlkYXRpbmcgZGF0ZXMgKmFuZCogdGltZXMgYXJlIGluIHJhbmdlXG5mdW5jdGlvbiBidWlsZFRpbWVCb3VuZGFyaWVzKHtcbiAgc3RhcnREYXRlLFxuICBlbmREYXRlLFxuICByYW5nZVN0YXJ0Qm91bmRhcnksXG4gIHJhbmdlRW5kQm91bmRhcnksXG59KSB7XG4gIGlmICghcmFuZ2VTdGFydEJvdW5kYXJ5IHx8ICFyYW5nZUVuZEJvdW5kYXJ5KSB7XG4gICAgcmV0dXJuIHt9O1xuICB9XG5cbiAgLy8gaW5pdCB3aXRoIGRlZmF1bHRzOiBhbGwgaG91cnMgb2YgZGF5XG4gIGNvbnN0IGJvdW5kYXJpZXMgPSB7XG4gICAgZW5kVGltZUJvdW5kYXJ5RW5kOiB0aW1lT2JqRnJvbU1vbWVudChtb21lbnQoKS5lbmRPZignZGF5JykpLFxuICAgIGVuZFRpbWVCb3VuZGFyeVN0YXJ0OiB0aW1lT2JqRnJvbU1vbWVudChtb21lbnQoKS5zdGFydE9mKCdkYXknKSksXG4gICAgc3RhcnRUaW1lQm91bmRhcnlFbmQ6IHRpbWVPYmpGcm9tTW9tZW50KG1vbWVudCgpLmVuZE9mKCdkYXknKSksXG4gICAgc3RhcnRUaW1lQm91bmRhcnlTdGFydDogdGltZU9iakZyb21Nb21lbnQobW9tZW50KCkuc3RhcnRPZignZGF5JykpLFxuICB9O1xuXG4gIGlmIChzdGFydERhdGUuaXNTYW1lKHJhbmdlU3RhcnRCb3VuZGFyeSwgJ2RheScpKSB7XG4gICAgYm91bmRhcmllcy5zdGFydFRpbWVCb3VuZGFyeVN0YXJ0ID0gdGltZU9iakZyb21Nb21lbnQocmFuZ2VTdGFydEJvdW5kYXJ5KTtcbiAgfVxuICBpZiAoc3RhcnREYXRlLmlzU2FtZShyYW5nZUVuZEJvdW5kYXJ5LCAnZGF5JykpIHtcbiAgICBib3VuZGFyaWVzLnN0YXJ0VGltZUJvdW5kYXJ5RW5kID0gdGltZU9iakZyb21Nb21lbnQocmFuZ2VFbmRCb3VuZGFyeSk7XG4gIH1cbiAgaWYgKGVuZERhdGUuaXNTYW1lKHJhbmdlU3RhcnRCb3VuZGFyeSwgJ2RheScpKSB7XG4gICAgYm91bmRhcmllcy5lbmRUaW1lQm91bmRhcnlTdGFydCA9IHRpbWVPYmpGcm9tTW9tZW50KHJhbmdlU3RhcnRCb3VuZGFyeSk7XG4gIH1cbiAgaWYgKGVuZERhdGUuaXNTYW1lKHJhbmdlRW5kQm91bmRhcnksICdkYXknKSkge1xuICAgIGJvdW5kYXJpZXMuZW5kVGltZUJvdW5kYXJ5RW5kID0gdGltZU9iakZyb21Nb21lbnQocmFuZ2VFbmRCb3VuZGFyeSk7XG4gIH1cbiAgcmV0dXJuIGJvdW5kYXJpZXM7XG59XG5cbkBSYWRpdW1cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFR4bERhdGVSYW5nZVNlbGVjdG9yIGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50IHtcbiAgY29uc3RydWN0b3IoLi4uYXJncykge1xuICAgIHN1cGVyKC4uLmFyZ3MpO1xuXG4gICAgY29uc3Qge1xuICAgICAgZW5kVGltZSxcbiAgICAgIHByZXNldEtleSxcbiAgICAgIHJhbmdlRW5kQm91bmRhcnksXG4gICAgICByYW5nZVN0YXJ0Qm91bmRhcnksXG4gICAgICBzdGFydFRpbWUsXG4gICAgICB0aW1lWm9uZSxcbiAgICAgIHZhbHVlLFxuICAgICAgdmFsdWU6IFtcbiAgICAgICAgc3RhcnREYXRlLFxuICAgICAgICBlbmREYXRlLFxuICAgICAgXSxcbiAgICB9ID0gdGhpcy5wcm9wcztcblxuICAgIC8vIG1haW50YWluICdhY3RpdmUnIGRhdGUgd2l0aGluIGNvbXBvbmVudCBmb3IgdXBkYXRpbmcgQ2FsZW5kYXJzIHdoZW4gbm90IGF1dG8tdXBkYXRpbmcuXG4gICAgdGhpcy5zdGF0ZSA9IHtcbiAgICAgIGFjdGl2ZUVuZFRpbWU6IGVuZFRpbWUsXG4gICAgICBhY3RpdmVQcmVzZXQ6IHByZXNldEtleSxcbiAgICAgIGFjdGl2ZVJhbmdlOiB2YWx1ZS5tYXAoZGF0ZVN0cmluZ1RvTW9tZW50KSxcbiAgICAgIGFjdGl2ZVN0YXJ0VGltZTogc3RhcnRUaW1lLFxuICAgICAgYWN0aXZlVGltZVpvbmU6IHRpbWVab25lLFxuICAgICAgZW5kVGltZU9wZW46IGZhbHNlLFxuICAgICAgc3RhcnRUaW1lT3BlbjogZmFsc2UsXG4gICAgICB0aW1lQm91bmRhcmllczogYnVpbGRUaW1lQm91bmRhcmllcyh7XG4gICAgICAgIGVuZERhdGUsXG4gICAgICAgIHJhbmdlRW5kQm91bmRhcnksXG4gICAgICAgIHJhbmdlU3RhcnRCb3VuZGFyeSxcbiAgICAgICAgc3RhcnREYXRlLFxuICAgICAgfSksXG4gICAgfTtcbiAgfVxuXG4gIGNvbXBvbmVudFdpbGxSZWNlaXZlUHJvcHMobmV4dFByb3BzKSB7XG4gICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICBhY3RpdmVFbmRUaW1lOiBuZXh0UHJvcHMuZW5kVGltZSxcbiAgICAgIGFjdGl2ZVByZXNldDogbmV4dFByb3BzLnByZXNldEtleSxcbiAgICAgIGFjdGl2ZVJhbmdlOiBuZXh0UHJvcHMudmFsdWUubWFwKGRhdGVTdHJpbmdUb01vbWVudCksXG4gICAgICBhY3RpdmVTdGFydFRpbWU6IG5leHRQcm9wcy5zdGFydFRpbWUsXG4gICAgICBhY3RpdmVUaW1lWm9uZTogbmV4dFByb3BzLnRpbWVab25lLFxuICAgIH0pO1xuICB9XG5cbiAgX2hhbmRsZURhdGVTZWxlY3QgPSAoeyBwcmVzZXRLZXksIHN0YXJ0RGF0ZSwgZW5kRGF0ZSB9KSA9PiB7XG4gICAgbGV0IG5ld0RhdGVTdGF0ZSA9IHtcbiAgICAgIGFjdGl2ZVByZXNldDogcHJlc2V0S2V5LFxuICAgICAgYWN0aXZlUmFuZ2U6IFtzdGFydERhdGUsIGVuZERhdGVdLFxuICAgIH07XG4gICAgaWYgKHByZXNldEtleSAhPT0gJ2N1c3RvbScpIHtcbiAgICAgIG5ld0RhdGVTdGF0ZSA9IHtcbiAgICAgICAgLi4ubmV3RGF0ZVN0YXRlLFxuICAgICAgICBhY3RpdmVFbmRUaW1lOiB0aW1lT2JqRnJvbU1vbWVudChlbmREYXRlKSxcbiAgICAgICAgYWN0aXZlU3RhcnRUaW1lOiB0aW1lT2JqRnJvbU1vbWVudChzdGFydERhdGUpLFxuICAgICAgfTtcbiAgICB9XG4gICAgdGhpcy5zZXRTdGF0ZShcbiAgICAgIG5ld0RhdGVTdGF0ZSxcbiAgICAgICgpID0+IHtcbiAgICAgICAgaWYgKHRoaXMucHJvcHMubW9kZSA9PT0gJ3NpbXBsZScpIHtcbiAgICAgICAgICAvLyBhcHBseSBkYXRlIGltbWVkaWF0ZWx5XG4gICAgICAgICAgdGhpcy5faGFuZGxlRGF0ZUNoYW5nZSh7IGVuZERhdGUsIHByZXNldEtleSwgc3RhcnREYXRlIH0pO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgKTtcbiAgfVxuXG4gIF9oYW5kbGVUaW1lWm9uZVNlbGVjdCA9ICh7IHZhbHVlIH0pID0+IHRoaXMuc2V0U3RhdGUoeyBhY3RpdmVUaW1lWm9uZTogdmFsdWUgfSlcblxuICBfaGFuZGxlQXBwbHlDbGljayA9ICgpID0+IHtcbiAgICBjb25zdCB7XG4gICAgICBhY3RpdmVFbmRUaW1lOiBlbmRUaW1lLFxuICAgICAgYWN0aXZlUHJlc2V0OiBwcmVzZXRLZXksXG4gICAgICBhY3RpdmVSYW5nZTogW1xuICAgICAgICBzdGFydERhdGUsXG4gICAgICAgIGVuZERhdGUsXG4gICAgICBdLFxuICAgICAgYWN0aXZlU3RhcnRUaW1lOiBzdGFydFRpbWUsXG4gICAgICBhY3RpdmVUaW1lWm9uZTogdGltZVpvbmUsXG4gICAgfSA9IHRoaXMuc3RhdGU7XG5cbiAgICB0aGlzLl9oYW5kbGVEYXRlQ2hhbmdlKHtcbiAgICAgIGVuZERhdGUsXG4gICAgICBlbmRUaW1lLFxuICAgICAgcHJlc2V0S2V5LFxuICAgICAgc3RhcnREYXRlLFxuICAgICAgc3RhcnRUaW1lLFxuICAgICAgdGltZVpvbmUsXG4gICAgfSk7XG4gIH1cblxuICBfaGFuZGxlRGF0ZUNoYW5nZSA9ICh7IHByZXNldEtleSwgc3RhcnREYXRlLCBlbmREYXRlLCBzdGFydFRpbWUsIGVuZFRpbWUsIHRpbWVab25lIH0pID0+IHtcbiAgICBjb25zdCB7XG4gICAgICBvbkNoYW5nZSxcbiAgICAgIHBhdHRlcm4sXG4gICAgfSA9IHRoaXMucHJvcHM7XG5cbiAgICBvbkNoYW5nZSh7XG4gICAgICBlbmRUaW1lLFxuICAgICAgcHJlc2V0S2V5LFxuICAgICAgc3RhcnRUaW1lLFxuICAgICAgdGltZVpvbmUsXG4gICAgICB2YWx1ZTogW1xuICAgICAgICBzdGFydERhdGUuZm9ybWF0KHBhdHRlcm4pLFxuICAgICAgICBlbmREYXRlLmZvcm1hdChwYXR0ZXJuKSxcbiAgICAgIF0sXG4gICAgfSk7XG4gICAgdGhpcy5fY2xvc2VEcm9wZG93bigpO1xuICB9XG5cbiAgX3RvZ2dsZURyb3Bkb3duID0gKCkgPT4gdGhpcy5wcm9wcy51cGRhdGVEcm9wZG93bih7IG9wZW46ICF0aGlzLnByb3BzLm9wZW4gfSlcblxuICBfY2xvc2VEcm9wZG93biA9ICgpID0+IHRoaXMucHJvcHMudXBkYXRlRHJvcGRvd24oeyBvcGVuOiBmYWxzZSB9KVxuXG4gIF9vcGVuRHJvcGRvd24gPSAoKSA9PiB0aGlzLnByb3BzLnVwZGF0ZURyb3Bkb3duKHsgb3BlbjogdHJ1ZSB9KVxuXG4gIF9oYW5kbGVFbmRUaW1lQ2xvc2UgPSAoKSA9PiB0aGlzLnNldFN0YXRlKHsgZW5kVGltZU9wZW46IGZhbHNlIH0pXG5cbiAgX2hhbmRsZUVuZFRpbWVPcGVuID0gKCkgPT4gdGhpcy5zZXRTdGF0ZSh7XG4gICAgZW5kVGltZU9wZW46IHRydWUsXG4gICAgc3RhcnRUaW1lT3BlbjogZmFsc2UsXG4gIH0pXG5cbiAgX2hhbmRsZUVuZFRpbWVSZWYgPSAocmVmKSA9PiB7IHRoaXMuX2VuZFRpbWVQaWNrZXIgPSByZWY7IH1cblxuICBfaGFuZGxlRW5kVGltZVNlbGVjdCA9IChpdGVtKSA9PiB7XG4gICAgY29uc3QgdGltZSA9IF9nZXRUaW1lRnJvbUl0ZW1TZWxlY3QoaXRlbSk7XG4gICAgdGltZSAmJiB0aGlzLnNldFN0YXRlKHsgYWN0aXZlRW5kVGltZTogdGltZSB9KTtcbiAgfVxuXG4gIF9oYW5kbGVTdGFydFRpbWVDbG9zZSA9ICgpID0+IHRoaXMuc2V0U3RhdGUoeyBzdGFydFRpbWVPcGVuOiBmYWxzZSB9KVxuXG4gIF9oYW5kbGVTdGFydFRpbWVPcGVuID0gKCkgPT4gdGhpcy5zZXRTdGF0ZSh7XG4gICAgZW5kVGltZU9wZW46IGZhbHNlLFxuICAgIHN0YXJ0VGltZU9wZW46IHRydWUsXG4gIH0pXG5cbiAgX2hhbmRsZVN0YXJ0VGltZVJlZiA9IChyZWYpID0+IHsgdGhpcy5fc3RhcnRUaW1lUGlja2VyID0gcmVmOyB9XG5cbiAgX2hhbmRsZVN0YXJ0VGltZVNlbGVjdCA9IChpdGVtKSA9PiB7XG4gICAgY29uc3QgdGltZSA9IF9nZXRUaW1lRnJvbUl0ZW1TZWxlY3QoaXRlbSk7XG4gICAgdGltZSAmJiB0aGlzLnNldFN0YXRlKHsgYWN0aXZlU3RhcnRUaW1lOiB0aW1lIH0pO1xuICB9XG5cbiAgcmVuZGVyKCkge1xuICAgIGNvbnN0IHsgcHJvcHMsIHN0YXRlIH0gPSB0aGlzO1xuICAgIGNvbnN0IHtcbiAgICAgIGRpc3BsYXlQYXR0ZXJuLFxuICAgICAgZm9vdGVyQ29udGVudCxcbiAgICAgIG1vZGUsXG4gICAgICBvcGVuLFxuICAgICAgb3V0T2ZSYW5nZVRvb2x0aXAsXG4gICAgICByYW5nZUVuZEJvdW5kYXJ5LFxuICAgICAgcmFuZ2VTdGFydEJvdW5kYXJ5LFxuICAgICAgc2Vjb25kYXJ5VGV4dCxcbiAgICAgIHZhbHVlLFxuICAgICAgb25DaGFuZ2UsXG4gICAgfSA9IHByb3BzO1xuXG4gICAgY29uc3Qge1xuICAgICAgYWN0aXZlRW5kVGltZSxcbiAgICAgIGFjdGl2ZVByZXNldCxcbiAgICAgIGFjdGl2ZVJhbmdlLFxuICAgICAgYWN0aXZlUmFuZ2U6IFtcbiAgICAgICAgYWN0aXZlU3RhcnREYXRlLFxuICAgICAgICBhY3RpdmVFbmREYXRlLFxuICAgICAgXSxcbiAgICAgIGFjdGl2ZVN0YXJ0VGltZSxcbiAgICAgIGFjdGl2ZVRpbWVab25lLFxuICAgICAgZW5kVGltZU9wZW4sXG4gICAgICBzdGFydFRpbWVPcGVuLFxuICAgIH0gPSBzdGF0ZTtcblxuICAgIC8vIFRpbWVQaWNrZXIgYm91bmRhcmllcyBoYXZlIHRvIHVwZGF0ZSB3aXRoIHJhbmdlIHNlbGVjdGlvblxuICAgIGNvbnN0IHtcbiAgICAgIGVuZFRpbWVCb3VuZGFyeUVuZCxcbiAgICAgIGVuZFRpbWVCb3VuZGFyeVN0YXJ0LFxuICAgICAgc3RhcnRUaW1lQm91bmRhcnlFbmQsXG4gICAgICBzdGFydFRpbWVCb3VuZGFyeVN0YXJ0LFxuICAgIH0gPSBidWlsZFRpbWVCb3VuZGFyaWVzKHtcbiAgICAgIGVuZERhdGU6IGFjdGl2ZUVuZERhdGUsXG4gICAgICByYW5nZUVuZEJvdW5kYXJ5LFxuICAgICAgcmFuZ2VTdGFydEJvdW5kYXJ5LFxuICAgICAgc3RhcnREYXRlOiBhY3RpdmVTdGFydERhdGUsXG4gICAgfSk7XG5cbiAgICBjb25zdCBkaXNwbGF5VmFsdWUgPSBidWlsZERpc3BsYXlWYWx1ZUZyb21EYXRlcyh2YWx1ZVswXSwgdmFsdWVbMV0sIGRpc3BsYXlQYXR0ZXJuKTtcbiAgICBjb25zdCBzaG93VGltZUFuZEZvb3RlciA9IG1vZGUgIT09ICdzaW1wbGUnO1xuICAgIGNvbnN0IHN0YXJ0VGltZVRleHRWYWx1ZSA9IF9mb3JtYXRUaW1lKGFjdGl2ZVN0YXJ0VGltZSk7XG4gICAgY29uc3QgZW5kVGltZVRleHRWYWx1ZSA9IF9mb3JtYXRUaW1lKGFjdGl2ZUVuZFRpbWUpO1xuXG4gICAgLy8gb25seSBlbmFibGUgYnV0dG9uIHdoZW4gbmV3IGRhdGUgaGFzIGJlZW4gc2VsZWN0ZWQgYW5kIHZhbHVlcyBhcmUgaW4gcmFuZ2VcbiAgICBjb25zdCBhcHBseUJ1dHRvbklzRGlzYWJsZWQgPSBpc0FwcGx5QnV0dG9uRGlzYWJsZWQocHJvcHMsIHN0YXRlKTtcblxuICAgIGNvbnN0IGRyb3Bkb3duSWNvbiA9IChcbiAgICAgIDxJY29uQnV0dG9uXG4gICAgICAgIGljb249e0NhbGVuZGFySWNvbn1cbiAgICAgICAgb25DbGljaz17dGhpcy5fdG9nZ2xlRHJvcGRvd259XG4gICAgICAgIHZhcmlhbnQ9XCJwbGFpblwiXG4gICAgICAvPlxuICAgICk7XG5cbiAgICByZXR1cm4gKFxuICAgICAgPGRpdlxuICAgICAgICBkYXRhLWNvbXBvbmVudD1cIlR4bERhdGVSYW5nZVNlbGVjdG9yXCJcbiAgICAgICAgc3R5bGU9e1dSQVBQRVJfU1RZTEV9XG4gICAgICA+XG4gICAgICAgIDxUZXh0RmllbGRcbiAgICAgICAgICBfYWZ0ZXJDb250ZW50PXtkcm9wZG93bkljb259XG4gICAgICAgICAgLy8gb25DbGljay9vbkNoYW5nZSBhcmVuJ3QgZXhwbGljaXQgVGV4dEZpZWxkIHByb3BzO1xuICAgICAgICAgIC8vIHRoZXkncmUgcGFzc2VkIHRvIGlucHV0IGVsZW0gdmlhICdvdGhlclByb3BzJ1xuICAgICAgICAgIG9uQ2hhbmdlPXtvbkNoYW5nZX1cbiAgICAgICAgICBvbkNsaWNrPXt0aGlzLl9vcGVuRHJvcGRvd259XG4gICAgICAgICAgcmVhZE9ubHlcbiAgICAgICAgICByZWY9XCJ0ZXh0RmllbGRcIlxuICAgICAgICAgIHNlY29uZGFyeVRleHQ9e3NlY29uZGFyeVRleHR9XG4gICAgICAgICAgdHlwZT1cInRleHRcIlxuICAgICAgICAgIHZhbHVlPXtkaXNwbGF5VmFsdWV9XG4gICAgICAgIC8+XG4gICAgICAgIDxJbnB1dFVuZGVybGluZSB2YWxpZGF0aW9uU3RhdGU9XCJiYXNlXCIgLz5cbiAgICAgICAgPERyb3Bkb3duQ29udGVudFxuICAgICAgICAgIHN0eWxlPXtEUk9QRE9XTl9DT05UQUlORVJfU1RZTEV9XG4gICAgICAgICAgb25Nb3VzZURvd249e3RoaXMuX2Rpc2FibGVCbHVyfVxuICAgICAgICAgIG9uQ2xpY2s9e3RoaXMuX2VuYWJsZUJsdXJ9XG4gICAgICAgICAgb3Blbj17b3Blbn1cbiAgICAgICAgPlxuICAgICAgICAgIDxDYWxlbmRhclBpY2tlcldpdGhQcmVzZXRzXG4gICAgICAgICAgICBvbkRhdGVTZWxlY3Q9e3RoaXMuX2hhbmRsZURhdGVTZWxlY3R9XG4gICAgICAgICAgICBvdXRPZlJhbmdlVG9vbHRpcD17b3V0T2ZSYW5nZVRvb2x0aXB9XG4gICAgICAgICAgICBwcmVzZXRLZXk9e2FjdGl2ZVByZXNldH1cbiAgICAgICAgICAgIHJhbmdlPXthY3RpdmVSYW5nZX1cbiAgICAgICAgICAgIHJhbmdlRW5kQm91bmRhcnk9e3JhbmdlRW5kQm91bmRhcnl9XG4gICAgICAgICAgICByYW5nZVN0YXJ0Qm91bmRhcnk9e3JhbmdlU3RhcnRCb3VuZGFyeX1cbiAgICAgICAgICAgIHJlZj1cImNhbFBpY2tlclwiXG4gICAgICAgICAgLz5cbiAgICAgICAgICB7c2hvd1RpbWVBbmRGb290ZXIgJiZcbiAgICAgICAgICAgIDxzZWN0aW9uPlxuICAgICAgICAgICAgICA8ZGl2IHN0eWxlPXtUSU1FX1dSQVBQRVJfU1RZTEV9PlxuICAgICAgICAgICAgICAgIDxkaXYgc3R5bGU9e1RJTUVfWk9ORV9XUkFQUEVSX1NUWUxFfT5cbiAgICAgICAgICAgICAgICAgIDxUaW1lWm9uZVBpY2tlclxuICAgICAgICAgICAgICAgICAgICBsYWJlbD17VElNRV9aT05FX1BJQ0tFUl9MQUJFTH1cbiAgICAgICAgICAgICAgICAgICAgb25JdGVtU2VsZWN0PXt0aGlzLl9oYW5kbGVUaW1lWm9uZVNlbGVjdH1cbiAgICAgICAgICAgICAgICAgICAgcmVmPVwidGltZVpvbmVQaWNrZXJcIlxuICAgICAgICAgICAgICAgICAgICB2YWx1ZT17YWN0aXZlVGltZVpvbmV9XG4gICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgIDxkaXY+XG4gICAgICAgICAgICAgICAgICA8ZGl2IHN0eWxlPXtMQUJFTF9TVFlMRX0+XG4gICAgICAgICAgICAgICAgICAgIHtUSU1FX1JBTkdFX1BJQ0tFUl9MQUJFTH1cbiAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgPGRpdiBzdHlsZT17VElNRV9SQU5HRV9XUkFQUEVSX1NUWUxFfT5cbiAgICAgICAgICAgICAgICAgICAgPGRpdiBzdHlsZT17VElNRV9QSUNLRVJfV1JBUFBFUl9TVFlMRX0+XG4gICAgICAgICAgICAgICAgICAgICAgPFRpbWVQaWNrZXJDb250cm9sbGVkXG4gICAgICAgICAgICAgICAgICAgICAgICBib3VuZGFyeUVuZD17c3RhcnRUaW1lQm91bmRhcnlFbmR9XG4gICAgICAgICAgICAgICAgICAgICAgICBib3VuZGFyeVN0YXJ0PXtzdGFydFRpbWVCb3VuZGFyeVN0YXJ0fVxuICAgICAgICAgICAgICAgICAgICAgICAgY2xvc2VEcm9wZG93bj17dGhpcy5faGFuZGxlU3RhcnRUaW1lQ2xvc2V9XG4gICAgICAgICAgICAgICAgICAgICAgICBvbkl0ZW1TZWxlY3Q9e3RoaXMuX2hhbmRsZVN0YXJ0VGltZVNlbGVjdH1cbiAgICAgICAgICAgICAgICAgICAgICAgIG9wZW49e3N0YXJ0VGltZU9wZW59XG4gICAgICAgICAgICAgICAgICAgICAgICBvcGVuRHJvcGRvd249e3RoaXMuX2hhbmRsZVN0YXJ0VGltZU9wZW59XG4gICAgICAgICAgICAgICAgICAgICAgICBwYXR0ZXJuPXtUSU1FX1BBVFRFUk59XG4gICAgICAgICAgICAgICAgICAgICAgICByZWY9e3RoaXMuX2hhbmRsZVN0YXJ0VGltZVJlZn1cbiAgICAgICAgICAgICAgICAgICAgICAgIHNlY29uZGFyeVRleHQ9e2J1aWxkVGltZVJhbmdlU2Vjb25kYXJ5VGV4dChhY3RpdmVTdGFydERhdGUpfVxuICAgICAgICAgICAgICAgICAgICAgICAgdGV4dFZhbHVlPXtzdGFydFRpbWVUZXh0VmFsdWV9XG4gICAgICAgICAgICAgICAgICAgICAgICB0aW1lPXthY3RpdmVTdGFydFRpbWV9XG4gICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG5cbiAgICAgICAgICAgICAgICAgICAgPGRpdiBzdHlsZT17SU5QVVRfU0VQQVJBVE9SX1NUWUxFfT5cbiAgICAgICAgICAgICAgICAgICAgICB7VElNRV9ERUxJTUlURVJfVEVYVH1cbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG5cbiAgICAgICAgICAgICAgICAgICAgPGRpdiBzdHlsZT17VElNRV9QSUNLRVJfV1JBUFBFUl9TVFlMRX0+XG4gICAgICAgICAgICAgICAgICAgICAgPFRpbWVQaWNrZXJDb250cm9sbGVkXG4gICAgICAgICAgICAgICAgICAgICAgICBib3VuZGFyeUVuZD17ZW5kVGltZUJvdW5kYXJ5RW5kfVxuICAgICAgICAgICAgICAgICAgICAgICAgYm91bmRhcnlTdGFydD17ZW5kVGltZUJvdW5kYXJ5U3RhcnR9XG4gICAgICAgICAgICAgICAgICAgICAgICBjbG9zZURyb3Bkb3duPXt0aGlzLl9oYW5kbGVFbmRUaW1lQ2xvc2V9XG4gICAgICAgICAgICAgICAgICAgICAgICBvbkl0ZW1TZWxlY3Q9e3RoaXMuX2hhbmRsZUVuZFRpbWVTZWxlY3R9XG4gICAgICAgICAgICAgICAgICAgICAgICBvcGVuPXtlbmRUaW1lT3Blbn1cbiAgICAgICAgICAgICAgICAgICAgICAgIG9wZW5Ecm9wZG93bj17dGhpcy5faGFuZGxlRW5kVGltZU9wZW59XG4gICAgICAgICAgICAgICAgICAgICAgICBwYXR0ZXJuPXtUSU1FX1BBVFRFUk59XG4gICAgICAgICAgICAgICAgICAgICAgICByZWY9e3RoaXMuX2hhbmRsZUVuZFRpbWVSZWZ9XG4gICAgICAgICAgICAgICAgICAgICAgICBzZWNvbmRhcnlUZXh0PXtidWlsZFRpbWVSYW5nZVNlY29uZGFyeVRleHQoYWN0aXZlRW5kRGF0ZSl9XG4gICAgICAgICAgICAgICAgICAgICAgICB0ZXh0VmFsdWU9e2VuZFRpbWVUZXh0VmFsdWV9XG4gICAgICAgICAgICAgICAgICAgICAgICB0aW1lPXthY3RpdmVFbmRUaW1lfVxuICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuXG4gICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgIDxmb290ZXIgc3R5bGU9e0ZPT1RFUl9TVFlMRX0+XG4gICAgICAgICAgICAgICAgPGRpdiBzdHlsZT17QlVUVE9OX0dST1VQX1NUWUxFfT5cbiAgICAgICAgICAgICAgICAgIDxCdXR0b25cbiAgICAgICAgICAgICAgICAgICAgX3N0eWxlPXtCVVRUT05fU1RZTEV9XG4gICAgICAgICAgICAgICAgICAgIGRpc2FibGVkPXthcHBseUJ1dHRvbklzRGlzYWJsZWR9XG4gICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9e3RoaXMuX2hhbmRsZUFwcGx5Q2xpY2t9XG4gICAgICAgICAgICAgICAgICAgIHJlZj1cImFwcGx5QnV0dG9uXCJcbiAgICAgICAgICAgICAgICAgICAgc2l6ZT1cImxhcmdlXCJcbiAgICAgICAgICAgICAgICAgICAgdmFyaWFudD1cImFjY2VudFwiXG4gICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgIHtBUFBMWV9CVVRUT05fVEVYVH1cbiAgICAgICAgICAgICAgICAgIDwvQnV0dG9uPlxuICAgICAgICAgICAgICAgICAgPEJ1dHRvblxuICAgICAgICAgICAgICAgICAgICBfc3R5bGU9e0JVVFRPTl9TVFlMRX1cbiAgICAgICAgICAgICAgICAgICAgb25DbGljaz17dGhpcy5fY2xvc2VEcm9wZG93bn1cbiAgICAgICAgICAgICAgICAgICAgcmVmPVwiY2FuY2VsQnV0dG9uXCJcbiAgICAgICAgICAgICAgICAgICAgc2l6ZT1cImxhcmdlXCJcbiAgICAgICAgICAgICAgICAgICAgdmFyaWFudD1cIm11dGVkXCJcbiAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAge0NBTkNFTF9CVVRUT05fVEVYVH1cbiAgICAgICAgICAgICAgICAgIDwvQnV0dG9uPlxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgIHtmb290ZXJDb250ZW50ICYmXG4gICAgICAgICAgICAgICAgPGRpdiBzdHlsZT17Rk9PVEVSX0NPTlRFTlRfU1RZTEV9PlxuICAgICAgICAgICAgICAgICAge2Zvb3RlckNvbnRlbnR9XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICA8L2Zvb3Rlcj5cbiAgICAgICAgICAgIDwvc2VjdGlvbj5cbiAgICAgICAgICB9XG4gICAgICAgIDwvRHJvcGRvd25Db250ZW50PlxuICAgICAgPC9kaXY+XG4gICAgKTtcbiAgfVxufVxuXG5UeGxEYXRlUmFuZ2VTZWxlY3Rvci5wcm9wVHlwZXMgPSB7XG4gIGRpc3BsYXlQYXR0ZXJuOiBQcm9wVHlwZXMuc3RyaW5nLFxuICBlbmRUaW1lOiBUaW1lUGlja2VyQ29udHJvbGxlZC5wcm9wVHlwZXMudGltZSxcbiAgZm9vdGVyQ29udGVudDogUHJvcFR5cGVzLm5vZGUsXG4gIG1vZGU6IFByb3BUeXBlcy5vbmVPZihbJ3NpbXBsZScsICdmdWxsJ10pLFxuICBvbkNoYW5nZTogUHJvcFR5cGVzLmZ1bmMuaXNSZXF1aXJlZCxcbiAgb3BlbjogUHJvcFR5cGVzLmJvb2wsXG4gIG91dE9mUmFuZ2VUb29sdGlwOiBDYWxlbmRhclBpY2tlcldpdGhQcmVzZXRzLnByb3BUeXBlcy5vdXRPZlJhbmdlVG9vbHRpcCxcbiAgcGF0dGVybjogUHJvcFR5cGVzLnN0cmluZyxcbiAgcHJlc2V0S2V5OiBDYWxlbmRhclBpY2tlcldpdGhQcmVzZXRzLnByb3BUeXBlcy5wcmVzZXRLZXksXG4gIHJhbmdlRW5kQm91bmRhcnk6IENhbGVuZGFyUGlja2VyV2l0aFByZXNldHMucHJvcFR5cGVzLnJhbmdlRW5kQm91bmRhcnksXG4gIHJhbmdlU3RhcnRCb3VuZGFyeTogQ2FsZW5kYXJQaWNrZXJXaXRoUHJlc2V0cy5wcm9wVHlwZXMucmFuZ2VTdGFydEJvdW5kYXJ5LFxuICBzZWNvbmRhcnlUZXh0OiBQcm9wVHlwZXMubm9kZSxcbiAgc3RhcnRUaW1lOiBUaW1lUGlja2VyQ29udHJvbGxlZC5wcm9wVHlwZXMudGltZSxcbiAgdGltZVpvbmU6IFRpbWVab25lUGlja2VyLnByb3BUeXBlcy52YWx1ZSxcbiAgdXBkYXRlRHJvcGRvd246IFByb3BUeXBlcy5mdW5jLFxuICB2YWx1ZTogVHhsUHJvcFR5cGVzLmRhdGVSYW5nZSxcbn07XG5cblR4bERhdGVSYW5nZVNlbGVjdG9yLmRlZmF1bHRQcm9wcyA9IHtcbiAgZGlzcGxheVBhdHRlcm46IENPTkRFTlNFRF9EQVRFX0ZPUk1BVCxcbiAgZW5kVGltZTogdGltZU9iakZyb21Nb21lbnQodG9kYXlQcmVzZXQuZW5kRGF0ZSksXG4gIG1vZGU6ICdmdWxsJyxcbiAgb3BlbjogZmFsc2UsXG4gIHBhdHRlcm46IERFRkFVTFRfREFURV9JTlBVVF9QQVRURVJOLFxuICBwcmVzZXRLZXk6ICd0b2RheScsXG4gIHN0YXJ0VGltZTogdGltZU9iakZyb21Nb21lbnQodG9kYXlQcmVzZXQuc3RhcnREYXRlKSxcbiAgdGltZVpvbmU6IG1vbWVudC50ei5ndWVzcygpLFxuICB1cGRhdGVEcm9wZG93bjogTk9PUCxcbiAgdmFsdWU6IFt0b2RheVByZXNldC5zdGFydERhdGUsIHRvZGF5UHJlc2V0LmVuZERhdGVdLFxufTtcbiJdfQ==