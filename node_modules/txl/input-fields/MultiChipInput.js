'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = undefined;

var _toConsumableArray2 = require('babel-runtime/helpers/toConsumableArray');

var _toConsumableArray3 = _interopRequireDefault(_toConsumableArray2);

var _getPrototypeOf = require('babel-runtime/core-js/object/get-prototype-of');

var _getPrototypeOf2 = _interopRequireDefault(_getPrototypeOf);

var _classCallCheck2 = require('babel-runtime/helpers/classCallCheck');

var _classCallCheck3 = _interopRequireDefault(_classCallCheck2);

var _createClass2 = require('babel-runtime/helpers/createClass');

var _createClass3 = _interopRequireDefault(_createClass2);

var _possibleConstructorReturn2 = require('babel-runtime/helpers/possibleConstructorReturn');

var _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);

var _inherits2 = require('babel-runtime/helpers/inherits');

var _inherits3 = _interopRequireDefault(_inherits2);

var _react = require('react');

var _react2 = _interopRequireDefault(_react);

var _MultiChipInputControlled = require('./MultiChipInputControlled');

var _MultiChipInputControlled2 = _interopRequireDefault(_MultiChipInputControlled);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

var _defaultValidator = function _defaultValidator() {
  return { isValid: true };
};

var DEFAULT_INVALID_TEXT = 'That value is invalid.';

var TxlMultiChipInput = function (_React$Component) {
  (0, _inherits3.default)(TxlMultiChipInput, _React$Component);

  function TxlMultiChipInput() {
    var _ref;

    (0, _classCallCheck3.default)(this, TxlMultiChipInput);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = (0, _possibleConstructorReturn3.default)(this, (_ref = TxlMultiChipInput.__proto__ || (0, _getPrototypeOf2.default)(TxlMultiChipInput)).call.apply(_ref, [this].concat(args)));

    _this._handleRef = function () {
      return _this.___handleRef__REACT_HOT_LOADER__.apply(_this, arguments);
    };

    _this._handleBlur = function () {
      return _this.___handleBlur__REACT_HOT_LOADER__.apply(_this, arguments);
    };

    _this._handleFocus = function () {
      return _this.___handleFocus__REACT_HOT_LOADER__.apply(_this, arguments);
    };

    _this._handleTextChange = function () {
      return _this.___handleTextChange__REACT_HOT_LOADER__.apply(_this, arguments);
    };

    _this._removeChip = function () {
      return _this.___removeChip__REACT_HOT_LOADER__.apply(_this, arguments);
    };

    _this._validateValue = function () {
      return _this.___validateValue__REACT_HOT_LOADER__.apply(_this, arguments);
    };

    var values = _this.props.values;

    _this.state = {
      validationState: 'base',
      values: values
    };
    return _this;
  }

  (0, _createClass3.default)(TxlMultiChipInput, [{
    key: '___handleRef__REACT_HOT_LOADER__',
    value: function ___handleRef__REACT_HOT_LOADER__() {
      return this.___handleRef__REACT_HOT_LOADER__.apply(this, arguments);
    }
  }, {
    key: '___handleRef__REACT_HOT_LOADER__',
    value: function ___handleRef__REACT_HOT_LOADER__(ref) {
      this._controlledComponent = ref;
    }
  }, {
    key: '___handleBlur__REACT_HOT_LOADER__',
    value: function ___handleBlur__REACT_HOT_LOADER__() {
      return this.___handleBlur__REACT_HOT_LOADER__.apply(this, arguments);
    }
  }, {
    key: '___handleBlur__REACT_HOT_LOADER__',
    value: function ___handleBlur__REACT_HOT_LOADER__(_ref2) {
      var value = _ref2.value;

      if (value === '') {
        this.setState({
          validationState: 'base',
          validationText: null
        });
      }
    }
  }, {
    key: '___handleFocus__REACT_HOT_LOADER__',
    value: function ___handleFocus__REACT_HOT_LOADER__() {
      return this.___handleFocus__REACT_HOT_LOADER__.apply(this, arguments);
    }
  }, {
    key: '___handleFocus__REACT_HOT_LOADER__',
    value: function ___handleFocus__REACT_HOT_LOADER__(_ref3) {
      var value = _ref3.value;

      this.setState({ textValue: value });
    }
  }, {
    key: '___handleTextChange__REACT_HOT_LOADER__',
    value: function ___handleTextChange__REACT_HOT_LOADER__() {
      return this.___handleTextChange__REACT_HOT_LOADER__.apply(this, arguments);
    }
  }, {
    key: '___handleTextChange__REACT_HOT_LOADER__',
    value: function ___handleTextChange__REACT_HOT_LOADER__(_ref4) {
      var value = _ref4.value;

      this.setState({ textValue: value });
    }
  }, {
    key: '___removeChip__REACT_HOT_LOADER__',
    value: function ___removeChip__REACT_HOT_LOADER__() {
      return this.___removeChip__REACT_HOT_LOADER__.apply(this, arguments);
    }
  }, {
    key: '___removeChip__REACT_HOT_LOADER__',
    value: function ___removeChip__REACT_HOT_LOADER__(value, idx) {
      var _this2 = this;

      // create a new array since splice mutates the array
      var values = [].concat((0, _toConsumableArray3.default)(this.state.values));
      values.splice(idx, 1);
      this.setState({ values: values }, function () {
        _this2.props.onChange({ value: values });
        _this2._controlledComponent.focus();
      });
    }
  }, {
    key: '___validateValue__REACT_HOT_LOADER__',
    value: function ___validateValue__REACT_HOT_LOADER__() {
      return this.___validateValue__REACT_HOT_LOADER__.apply(this, arguments);
    }
  }, {
    key: '___validateValue__REACT_HOT_LOADER__',
    value: function ___validateValue__REACT_HOT_LOADER__(_ref5) {
      var _this3 = this;

      var value = _ref5.value;
      var validator = this.props.validator;
      var values = this.state.values;

      var _validator = validator({ value: value, values: values }),
          isValid = _validator.isValid,
          validationText = _validator.validationText;

      var state = {};

      if (isValid || value === '') {
        state = {
          textValue: '',
          validationState: 'base',
          validationText: null,
          values: [].concat(this.state.values,
          // if value is empty string, we want to reset validation state, but not add new chip
          value !== '' ? [value] : [])
        };
      } else {
        state = {
          textValue: value.replace(/\s{2}/g, ' '),
          validationState: 'error',
          validationText: validationText || DEFAULT_INVALID_TEXT
        };
      }
      this.setState(state, function () {
        _this3._controlledComponent.focus();
      });
    }
  }, {
    key: 'render',
    value: function render() {
      var _props = this.props,
          disabled = _props.disabled,
          label = _props.label,
          placeholder = _props.placeholder,
          secondaryText = _props.secondaryText;
      var _state = this.state,
          textValue = _state.textValue,
          validationState = _state.validationState,
          validationText = _state.validationText,
          values = _state.values;


      return _react2.default.createElement(
        'div',
        { 'data-component': 'TxlMultiChipInput' },
        _react2.default.createElement(_MultiChipInputControlled2.default, {
          disabled: disabled,
          label: label,
          onBlur: this._handleBlur,
          onChipDelete: this._removeChip,
          onFocus: this._handleFocus,
          onTextChange: this._handleTextChange,
          onValidate: this._validateValue,
          placeholder: placeholder,
          ref: this._handleRef,
          secondaryText: validationText || secondaryText,
          textValue: textValue,
          validationState: validationState,
          values: values
        })
      );
    }
  }]);
  return TxlMultiChipInput;
}(_react2.default.Component);

exports.default = TxlMultiChipInput;


TxlMultiChipInput.displayName = 'TxlMultiChipInput';

TxlMultiChipInput.propTypes = {
  disabled: _MultiChipInputControlled2.default.propTypes.disabled,
  label: _MultiChipInputControlled2.default.propTypes.label,
  onChange: _react.PropTypes.func,
  placeholder: _MultiChipInputControlled2.default.propTypes.placeholder,
  secondaryText: _MultiChipInputControlled2.default.propTypes.secondaryText,
  validator: _react.PropTypes.func,
  values: _MultiChipInputControlled2.default.propTypes.values
};

TxlMultiChipInput.defaultProps = {
  onChange: Function.prototype,
  validator: _defaultValidator,
  values: []
};
;

var _temp = function () {
  if (typeof __REACT_HOT_LOADER__ === 'undefined') {
    return;
  }

  __REACT_HOT_LOADER__.register(_defaultValidator, '_defaultValidator', 'src/input-fields/MultiChipInput.jsx');

  __REACT_HOT_LOADER__.register(DEFAULT_INVALID_TEXT, 'DEFAULT_INVALID_TEXT', 'src/input-fields/MultiChipInput.jsx');

  __REACT_HOT_LOADER__.register(TxlMultiChipInput, 'TxlMultiChipInput', 'src/input-fields/MultiChipInput.jsx');
}();

;
module.exports = exports['default'];
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9pbnB1dC1maWVsZHMvTXVsdGlDaGlwSW5wdXQuanN4Il0sIm5hbWVzIjpbIl9kZWZhdWx0VmFsaWRhdG9yIiwiaXNWYWxpZCIsIkRFRkFVTFRfSU5WQUxJRF9URVhUIiwiVHhsTXVsdGlDaGlwSW5wdXQiLCJhcmdzIiwiX2hhbmRsZVJlZiIsIl9oYW5kbGVCbHVyIiwiX2hhbmRsZUZvY3VzIiwiX2hhbmRsZVRleHRDaGFuZ2UiLCJfcmVtb3ZlQ2hpcCIsIl92YWxpZGF0ZVZhbHVlIiwidmFsdWVzIiwicHJvcHMiLCJzdGF0ZSIsInZhbGlkYXRpb25TdGF0ZSIsInJlZiIsIl9jb250cm9sbGVkQ29tcG9uZW50IiwidmFsdWUiLCJzZXRTdGF0ZSIsInZhbGlkYXRpb25UZXh0IiwidGV4dFZhbHVlIiwiaWR4Iiwic3BsaWNlIiwib25DaGFuZ2UiLCJmb2N1cyIsInZhbGlkYXRvciIsImNvbmNhdCIsInJlcGxhY2UiLCJkaXNhYmxlZCIsImxhYmVsIiwicGxhY2Vob2xkZXIiLCJzZWNvbmRhcnlUZXh0IiwiQ29tcG9uZW50IiwiZGlzcGxheU5hbWUiLCJwcm9wVHlwZXMiLCJmdW5jIiwiZGVmYXVsdFByb3BzIiwiRnVuY3Rpb24iLCJwcm90b3R5cGUiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTs7OztBQUVBOzs7Ozs7QUFFQSxJQUFNQSxvQkFBb0IsU0FBcEJBLGlCQUFvQjtBQUFBLFNBQU8sRUFBRUMsU0FBUyxJQUFYLEVBQVA7QUFBQSxDQUExQjs7QUFFQSxJQUFNQyx1QkFBdUIsd0JBQTdCOztJQUVxQkMsaUI7OztBQUNuQiwrQkFBcUI7QUFBQTs7QUFBQTs7QUFBQSxzQ0FBTkMsSUFBTTtBQUFOQSxVQUFNO0FBQUE7O0FBQUEsdUxBQ1ZBLElBRFU7O0FBQUEsVUFXckJDLFVBWHFCO0FBQUE7QUFBQTs7QUFBQSxVQWVyQkMsV0FmcUI7QUFBQTtBQUFBOztBQUFBLFVBd0JyQkMsWUF4QnFCO0FB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Q2hpcElucHV0LmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFJlYWN0LCB7IFByb3BUeXBlcyB9IGZyb20gJ3JlYWN0JztcblxuaW1wb3J0IE11bHRpQ2hpcElucHV0Q29udHJvbGxlZCBmcm9tICcuL011bHRpQ2hpcElucHV0Q29udHJvbGxlZCc7XG5cbmNvbnN0IF9kZWZhdWx0VmFsaWRhdG9yID0gKCkgPT4gKHsgaXNWYWxpZDogdHJ1ZSB9KTtcblxuY29uc3QgREVGQVVMVF9JTlZBTElEX1RFWFQgPSAnVGhhdCB2YWx1ZSBpcyBpbnZhbGlkLic7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFR4bE11bHRpQ2hpcElucHV0IGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50IHtcbiAgY29uc3RydWN0b3IoLi4uYXJncykge1xuICAgIHN1cGVyKC4uLmFyZ3MpO1xuICAgIGNvbnN0IHtcbiAgICAgIHZhbHVlcyxcbiAgICB9ID0gdGhpcy5wcm9wcztcbiAgICB0aGlzLnN0YXRlID0ge1xuICAgICAgdmFsaWRhdGlvblN0YXRlOiAnYmFzZScsXG4gICAgICB2YWx1ZXMsXG4gICAgfTtcbiAgfVxuXG4gIF9oYW5kbGVSZWYgPSAocmVmKSA9PiB7XG4gICAgdGhpcy5fY29udHJvbGxlZENvbXBvbmVudCA9IHJlZjtcbiAgfVxuXG4gIF9oYW5kbGVCbHVyID0gKHsgdmFsdWUgfSkgPT4ge1xuICAgIGlmICh2YWx1ZSA9PT0gJycpIHtcbiAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICB2YWxpZGF0aW9uU3RhdGU6ICdiYXNlJyxcbiAgICAgICAgdmFsaWRhdGlvblRleHQ6IG51bGwsXG4gICAgICB9KTtcbiAgICB9XG4gIH1cblxuICBfaGFuZGxlRm9jdXMgPSAoeyB2YWx1ZSB9KSA9PiB7XG4gICAgdGhpcy5zZXRTdGF0ZSh7IHRleHRWYWx1ZTogdmFsdWUgfSk7XG4gIH1cblxuICBfaGFuZGxlVGV4dENoYW5nZSA9ICh7IHZhbHVlIH0pID0+IHtcbiAgICB0aGlzLnNldFN0YXRlKHsgdGV4dFZhbHVlOiB2YWx1ZSB9KTtcbiAgfVxuXG4gIF9yZW1vdmVDaGlwID0gKHZhbHVlLCBpZHgpID0+IHtcbiAgICAvLyBjcmVhdGUgYSBuZXcgYXJyYXkgc2luY2Ugc3BsaWNlIG11dGF0ZXMgdGhlIGFycmF5XG4gICAgY29uc3QgdmFsdWVzID0gWy4uLnRoaXMuc3RhdGUudmFsdWVzXTtcbiAgICB2YWx1ZXMuc3BsaWNlKGlkeCwgMSk7XG4gICAgdGhpcy5zZXRTdGF0ZSh7IHZhbHVlcyB9LCAoKSA9PiB7XG4gICAgICB0aGlzLnByb3BzLm9uQ2hhbmdlKHsgdmFsdWU6IHZhbHVlcyB9KTtcbiAgICAgIHRoaXMuX2NvbnRyb2xsZWRDb21wb25lbnQuZm9jdXMoKTtcbiAgICB9KTtcbiAgfVxuXG4gIF92YWxpZGF0ZVZhbHVlID0gKHsgdmFsdWUgfSkgPT4ge1xuICAgIGNvbnN0IHtcbiAgICAgIHZhbGlkYXRvcixcbiAgICB9ID0gdGhpcy5wcm9wcztcbiAgICBjb25zdCB7XG4gICAgICB2YWx1ZXMsXG4gICAgfSA9IHRoaXMuc3RhdGU7XG4gICAgY29uc3Qge1xuICAgICAgaXNWYWxpZCxcbiAgICAgIHZhbGlkYXRpb25UZXh0LFxuICAgIH0gPSB2YWxpZGF0b3IoeyB2YWx1ZSwgdmFsdWVzIH0pO1xuICAgIGxldCBzdGF0ZSA9IHt9O1xuXG4gICAgaWYgKGlzVmFsaWQgfHwgdmFsdWUgPT09ICcnKSB7XG4gICAgICBzdGF0ZSA9IHtcbiAgICAgICAgdGV4dFZhbHVlOiAnJyxcbiAgICAgICAgdmFsaWRhdGlvblN0YXRlOiAnYmFzZScsXG4gICAgICAgIHZhbGlkYXRpb25UZXh0OiBudWxsLFxuICAgICAgICB2YWx1ZXM6IFtdLmNvbmNhdChcbiAgICAgICAgICB0aGlzLnN0YXRlLnZhbHVlcyxcbiAgICAgICAgICAvLyBpZiB2YWx1ZSBpcyBlbXB0eSBzdHJpbmcsIHdlIHdhbnQgdG8gcmVzZXQgdmFsaWRhdGlvbiBzdGF0ZSwgYnV0IG5vdCBhZGQgbmV3IGNoaXBcbiAgICAgICAgICB2YWx1ZSAhPT0gJycgPyBbdmFsdWVdIDogW11cbiAgICAgICAgKSxcbiAgICAgIH07XG4gICAgfSBlbHNlIHtcbiAgICAgIHN0YXRlID0ge1xuICAgICAgICB0ZXh0VmFsdWU6IHZhbHVlLnJlcGxhY2UoL1xcc3syfS9nLCAnICcpLFxuICAgICAgICB2YWxpZGF0aW9uU3RhdGU6ICdlcnJvcicsXG4gICAgICAgIHZhbGlkYXRpb25UZXh0OiB2YWxpZGF0aW9uVGV4dCB8fCBERUZBVUxUX0lOVkFMSURfVEVYVCxcbiAgICAgIH07XG4gICAgfVxuICAgIHRoaXMuc2V0U3RhdGUoc3RhdGUsICgpID0+IHtcbiAgICAgIHRoaXMuX2NvbnRyb2xsZWRDb21wb25lbnQuZm9jdXMoKTtcbiAgICB9KTtcbiAgfVxuXG4gIHJlbmRlcigpIHtcbiAgICBjb25zdCB7XG4gICAgICBkaXNhYmxlZCxcbiAgICAgIGxhYmVsLFxuICAgICAgcGxhY2Vob2xkZXIsXG4gICAgICBzZWNvbmRhcnlUZXh0LFxuICAgIH0gPSB0aGlzLnByb3BzO1xuXG4gICAgY29uc3Qge1xuICAgICAgdGV4dFZhbHVlLFxuICAgICAgdmFsaWRhdGlvblN0YXRlLFxuICAgICAgdmFsaWRhdGlvblRleHQsXG4gICAgICB2YWx1ZXMsXG4gICAgfSA9IHRoaXMuc3RhdGU7XG5cbiAgICByZXR1cm4gKFxuICAgICAgPGRpdiBkYXRhLWNvbXBvbmVudD1cIlR4bE11bHRpQ2hpcElucHV0XCI+XG4gICAgICAgIDxNdWx0aUNoaXBJbnB1dENvbnRyb2xsZWRcbiAgICAgICAgICBkaXNhYmxlZD17ZGlzYWJsZWR9XG4gICAgICAgICAgbGFiZWw9e2xhYmVsfVxuICAgICAgICAgIG9uQmx1cj17dGhpcy5faGFuZGxlQmx1cn1cbiAgICAgICAgICBvbkNoaXBEZWxldGU9e3RoaXMuX3JlbW92ZUNoaXB9XG4gICAgICAgICAgb25Gb2N1cz17dGhpcy5faGFuZGxlRm9jdXN9XG4gICAgICAgICAgb25UZXh0Q2hhbmdlPXt0aGlzLl9oYW5kbGVUZXh0Q2hhbmdlfVxuICAgICAgICAgIG9uVmFsaWRhdGU9e3RoaXMuX3ZhbGlkYXRlVmFsdWV9XG4gICAgICAgICAgcGxhY2Vob2xkZXI9e3BsYWNlaG9sZGVyfVxuICAgICAgICAgIHJlZj17dGhpcy5faGFuZGxlUmVmfVxuICAgICAgICAgIHNlY29uZGFyeVRleHQ9e3ZhbGlkYXRpb25UZXh0IHx8IHNlY29uZGFyeVRleHR9XG4gICAgICAgICAgdGV4dFZhbHVlPXt0ZXh0VmFsdWV9XG4gICAgICAgICAgdmFsaWRhdGlvblN0YXRlPXt2YWxpZGF0aW9uU3RhdGV9XG4gICAgICAgICAgdmFsdWVzPXt2YWx1ZXN9XG4gICAgICAgIC8+XG4gICAgICA8L2Rpdj5cbiAgICApO1xuICB9XG59XG5cblR4bE11bHRpQ2hpcElucHV0LmRpc3BsYXlOYW1lID0gJ1R4bE11bHRpQ2hpcElucHV0JztcblxuVHhsTXVsdGlDaGlwSW5wdXQucHJvcFR5cGVzID0ge1xuICBkaXNhYmxlZDogTXVsdGlDaGlwSW5wdXRDb250cm9sbGVkLnByb3BUeXBlcy5kaXNhYmxlZCxcbiAgbGFiZWw6IE11bHRpQ2hpcElucHV0Q29udHJvbGxlZC5wcm9wVHlwZXMubGFiZWwsXG4gIG9uQ2hhbmdlOiBQcm9wVHlwZXMuZnVuYyxcbiAgcGxhY2Vob2xkZXI6IE11bHRpQ2hpcElucHV0Q29udHJvbGxlZC5wcm9wVHlwZXMucGxhY2Vob2xkZXIsXG4gIHNlY29uZGFyeVRleHQ6IE11bHRpQ2hpcElucHV0Q29udHJvbGxlZC5wcm9wVHlwZXMuc2Vjb25kYXJ5VGV4dCxcbiAgdmFsaWRhdG9yOiBQcm9wVHlwZXMuZnVuYyxcbiAgdmFsdWVzOiBNdWx0aUNoaXBJbnB1dENvbnRyb2xsZWQucHJvcFR5cGVzLnZhbHVlcyxcbn07XG5cblR4bE11bHRpQ2hpcElucHV0LmRlZmF1bHRQcm9wcyA9IHtcbiAgb25DaGFuZ2U6IEZ1bmN0aW9uLnByb3RvdHlwZSxcbiAgdmFsaWRhdG9yOiBfZGVmYXVsdFZhbGlkYXRvcixcbiAgdmFsdWVzOiBbXSxcbn07XG4iXX0=