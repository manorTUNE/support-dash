'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.TIME_QUERY_FORMAT = exports.DATE_QUERY_FORMAT = exports.DATE_RANGE_FORMAT = undefined;

var _getOwnPropertyDescriptor = require('babel-runtime/core-js/object/get-own-property-descriptor');

var _getOwnPropertyDescriptor2 = _interopRequireDefault(_getOwnPropertyDescriptor);

var _getPrototypeOf = require('babel-runtime/core-js/object/get-prototype-of');

var _getPrototypeOf2 = _interopRequireDefault(_getPrototypeOf);

var _classCallCheck2 = require('babel-runtime/helpers/classCallCheck');

var _classCallCheck3 = _interopRequireDefault(_classCallCheck2);

var _createClass2 = require('babel-runtime/helpers/createClass');

var _createClass3 = _interopRequireDefault(_createClass2);

var _possibleConstructorReturn2 = require('babel-runtime/helpers/possibleConstructorReturn');

var _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);

var _inherits2 = require('babel-runtime/helpers/inherits');

var _inherits3 = _interopRequireDefault(_inherits2);

var _class, _desc, _value, _class2;

var _react = require('react');

var _react2 = _interopRequireDefault(_react);

var _radium = require('radium');

var _radium2 = _interopRequireDefault(_radium);

var _moment = require('moment');

var _moment2 = _interopRequireDefault(_moment);

var _isEqual = require('lodash/isEqual');

var _isEqual2 = _interopRequireDefault(_isEqual);

var _Base = require('../base/Base');

var _DateTimeRangePicker = require('./DateTimeRangePicker.style');

var _theme = require('../styles/theme');

var _Button = require('../buttons/Button');

var _Button2 = _interopRequireDefault(_Button);

var _ButtonSelect = require('../dropdowns/ButtonSelect');

var _ButtonSelect2 = _interopRequireDefault(_ButtonSelect);

var _DatePicker = require('../input-fields/DatePicker');

var _DatePicker2 = _interopRequireDefault(_DatePicker);

var _DateTimeConstants = require('./_DateTimeConstants');

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _applyDecoratedDescriptor(target, property, decorators, descriptor, context) {
  var desc = {};
  Object['ke' + 'ys'](descriptor).forEach(function (key) {
    desc[key] = descriptor[key];
  });
  desc.enumerable = !!desc.enumerable;
  desc.configurable = !!desc.configurable;

  if ('value' in desc || desc.initializer) {
    desc.writable = true;
  }

  desc = decorators.slice().reverse().reduce(function (desc, decorator) {
    return decorator(target, property, desc) || desc;
  }, desc);

  if (context && desc.initializer !== void 0) {
    desc.value = desc.initializer ? desc.initializer.call(context) : void 0;
    desc.initializer = undefined;
  }

  if (desc.initializer === void 0) {
    Object['define' + 'Property'](target, property, desc);
    desc = null;
  }

  return desc;
}

var DATE_RANGE_FORMAT = 'll';
var DATE_QUERY_FORMAT = 'YYYY-MM-DD';
var TIME_QUERY_FORMAT = 'HH:mm:ss';
var DATE_VALIDATION = 'Please select a date range in chronological order';
var CUSTOM_PRESET_KEY = 'custom';

exports.DATE_RANGE_FORMAT = DATE_RANGE_FORMAT;
exports.DATE_QUERY_FORMAT = DATE_QUERY_FORMAT;
exports.TIME_QUERY_FORMAT = TIME_QUERY_FORMAT;

var TxlDateRangePicker = (0, _radium2.default)(_class = (_class2 = function (_React$Component) {
  (0, _inherits3.default)(TxlDateRangePicker, _React$Component);

  function TxlDateRangePicker() {
    var _ref;

    var _temp, _this, _ret;

    (0, _classCallCheck3.default)(this, TxlDateRangePicker);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    return _ret = (_temp = (_this = (0, _possibleConstructorReturn3.default)(this, (_ref = TxlDateRangePicker.__proto__ || (0, _getPrototypeOf2.default)(TxlDateRangePicker)).call.apply(_ref, [this].concat(args))), _this), _this.state = {
      customDateRangeEnd: (0, _moment2.default)(_this.props.items.endDateTime).format(DATE_RANGE_FORMAT),
      customDateRangeStart: (0, _moment2.default)(_this.props.items.startDateTime).format(DATE_RANGE_FORMAT),
      previousPreset: _this.props.items.preset,
      selectedDateRangeEnd: (0, _moment2.default)(_this.props.items.endDateTime).format(DATE_QUERY_FORMAT),
      selectedDateRangeStart: (0, _moment2.default)(_this.props.items.startDateTime).format(DATE_QUERY_FORMAT),
      selectedPreset: _this.props.items.preset,
      showCustomDatePicker: false
    }, _temp), (0, _possibleConstructorReturn3.default)(_this, _ret);
  }

  (0, _createClass3.default)(TxlDateRangePicker, [{
    key: 'componentDidMount',
    value: function componentDidMount() {
      this._checkPreset();
    }
  }, {
    key: 'componentWillReceiveProps',
    value: function componentWillReceiveProps(nextProps) {
      if (!(0, _isEqual2.default)(this.props, nextProps)) {
        this.setState({
          customDateRangeEnd: (0, _moment2.default)(nextProps.items.endDateTime).format(DATE_RANGE_FORMAT),
          customDateRangeStart: (0, _moment2.default)(nextProps.items.startDateTime).format(DATE_RANGE_FORMAT),
          previousPreset: this.props.items.preset,
          selectedDateRangeEnd: (0, _moment2.default)(nextProps.items.endDateTime).format(DATE_QUERY_FORMAT),
          selectedDateRangeStart: (0, _moment2.default)(nextProps.items.startDateTime).format(DATE_QUERY_FORMAT),
          selectedPreset: nextProps.items.preset
        }, this._checkPreset);
      }
    }
  }, {
    key: '_isDateRangeValid',
    value: function _isDateRangeValid(start, end) {
      return (0, _moment2.default)(end, DATE_RANGE_FORMAT).diff((0, _moment2.default)(start, DATE_RANGE_FORMAT)) >= 0;
    }
  }, {
    key: '_togglePresets',
    value: function _togglePresets() {
      this.props.updateDropdown({ open: !this.props.open });
    }
  }, {
    key: '_handlePresetSelect',
    value: function _handlePresetSelect(item) {
      var _this2 = this;

      var selectedPreset = this.state.selectedPreset;


      this._togglePresets();

      if (item.value === 'custom') {
        this.setState({
          previousPreset: selectedPreset,
          selectedPreset: item,
          showCustomDatePicker: true
        }, this._updateChange);
      } else {
        this.setState({
          showCustomDatePicker: true
        }, function () {
          _this2.setState({
            customDateRangeEnd: item.endDate.format(DATE_RANGE_FORMAT),
            customDateRangeStart: item.startDate.format(DATE_RANGE_FORMAT),
            previousPreset: selectedPreset,
            selectedDateRangeEnd: item.endDate.format(DATE_QUERY_FORMAT),
            selectedDateRangeStart: item.startDate.format(DATE_QUERY_FORMAT),
            selectedPreset: item,
            showCustomDatePicker: false
          }, function () {
            _this2._checkPreset();
            _this2._updateChange();
          });
        });
      }
    }
  }, {
    key: '_checkPreset',
    value: function _checkPreset() {
      var selectedPreset = this.state.selectedPreset;

      var rangeDates = selectedPreset.range.split(' - ');
      if (rangeDates[0] === rangeDates[1]) {
        selectedPreset.range = rangeDates[0];
        this.setState({ selectedPreset: selectedPreset });
      }
    }
  }, {
    key: '_cancelCustomDateRange',
    value: function _cancelCustomDateRange() {
      var preset = this.state.previousPreset;
      if (!preset.range.includes('-')) {
        preset.range = preset.range + ' - ' + preset.range;
      }

      this.setState({
        customDateRangeEnd: (0, _moment2.default)(this.state.selectedDateRangeEnd).format(DATE_RANGE_FORMAT),
        customDateRangeStart: (0, _moment2.default)(this.state.selectedDateRangeStart).format(DATE_RANGE_FORMAT),
        selectedPreset: preset,
        showCustomDatePicker: !this.state.showCustomDatePicker
      }, this._checkPreset);
    }
  }, {
    key: '_applyCustomDateRange',
    value: function _applyCustomDateRange() {
      var _this3 = this;

      var _state = this.state,
          customDateRangeStart = _state.customDateRangeStart,
          customDateRangeEnd = _state.customDateRangeEnd,
          showCustomDatePicker = _state.showCustomDatePicker;


      var startDate = (0, _moment2.default)(customDateRangeStart, DATE_RANGE_FORMAT);
      var endDate = (0, _moment2.default)(customDateRangeEnd, DATE_RANGE_FORMAT);
      var formattedStartDate = startDate.format(DATE_RANGE_FORMAT);
      var formattedEndDate = endDate.format(DATE_RANGE_FORMAT);

      this.setState({
        selectedDateRangeEnd: endDate.format(DATE_QUERY_FORMAT),
        selectedDateRangeStart: startDate.format(DATE_QUERY_FORMAT)
      }, function () {
        // TODO: find another way to set preset by using state.selectedPreset
        var preset = {
          endDate: endDate,
          label: 'Custom date range',
          range: formattedStartDate + ' - ' + formattedEndDate,
          startDate: startDate,
          value: 'custom'
        };
        _this3.setState({
          selectedPreset: preset,
          showCustomDatePicker: !showCustomDatePicker
        }, _this3._updateChange);
      });
    }
  }, {
    key: '_getDateRangeOptions',
    value: function _getDateRangeOptions() {
      var _this4 = this;

      return (this.props.presets || (0, _DateTimeConstants.DATE_RANGE_PRESETS)()).map(function (preset) {
        var startDate = (0, _moment2.default)(preset.startDate).format(DATE_RANGE_FORMAT);
        var endDate = (0, _moment2.default)(preset.endDate).format(DATE_RANGE_FORMAT);
        if (preset.key === CUSTOM_PRESET_KEY && _this4.state) {
          startDate = (0, _moment2.default)(_this4.state.selectedDateRangeStart).format(DATE_RANGE_FORMAT);
          endDate = (0, _moment2.default)(_this4.state.selectedDateRangeEnd).format(DATE_RANGE_FORMAT);
        }
        return {
          endDate: (0, _moment2.default)(endDate, DATE_RANGE_FORMAT),
          label: preset.label,
          range: startDate + ' - ' + endDate,
          startDate: (0, _moment2.default)(startDate, DATE_RANGE_FORMAT),
          value: preset.key
        };
      });
    }
  }, {
    key: '_handleCustomStartDateChange',
    value: function _handleCustomStartDateChange(date) {
      this.setState({
        customDateRangeStart: (0, _moment2.default)(date.value, DATE_RANGE_FORMAT).format(DATE_RANGE_FORMAT)
      });
    }
  }, {
    key: '_handleCustomEndDateChange',
    value: function _handleCustomEndDateChange(date) {
      this.setState({
        customDateRangeEnd: (0, _moment2.default)(date.value, DATE_RANGE_FORMAT).format(DATE_RANGE_FORMAT)
      });
    }
  }, {
    key: '_updateChange',
    value: function _updateChange() {
      var _state2 = this.state,
          selectedDateRangeStart = _state2.selectedDateRangeStart,
          selectedDateRangeEnd = _state2.selectedDateRangeEnd,
          selectedPreset = _state2.selectedPreset;
      var _props = this.props,
          items = _props.items,
          onChange = _props.onChange;

      var startTime = (0, _moment2.default)(items.startDateTime).format(TIME_QUERY_FORMAT);
      var endTime = (0, _moment2.default)(items.endDateTime).format(TIME_QUERY_FORMAT);
      items.preset = selectedPreset;
      items.startDateTime = selectedDateRangeStart + ' ' + startTime;
      items.endDateTime = selectedDateRangeEnd + ' ' + endTime;
      onChange(items);
    }
  }, {
    key: '_renderDateRangeOptions',
    value: function _renderDateRangeOptions() {
      var _state3 = this.state,
          customDateRangeStart = _state3.customDateRangeStart,
          customDateRangeEnd = _state3.customDateRangeEnd,
          selectedPreset = _state3.selectedPreset,
          showCustomDatePicker = _state3.showCustomDatePicker;
      var _props2 = this.props,
          buttonItems = _props2.buttonItems,
          open = _props2.open;


      var COLOR_APP_THEME = (0, _theme.determineColorAppTheme)(this.context.txlAppTheme);
      var BUTTON_CANCEL = {
        color: COLOR_APP_THEME['500']
      };

      if (showCustomDatePicker) {
        var checkValid = this._isDateRangeValid(customDateRangeStart, customDateRangeEnd);

        return _react2.default.createElement(
          'div',
          { style: _DateTimeRangePicker.CUSTOM_DATE_RANGE },
          _react2.default.createElement(
            'div',
            { style: _DateTimeRangePicker.CUSTOM_DATE_CONTAINER },
            _react2.default.createElement(_DatePicker2.default, {
              isValid: checkValid,
              onChange: this._handleCustomStartDateChange,
              pattern: DATE_RANGE_FORMAT,
              validationText: ' ',
              value: customDateRangeStart
            })
          ),
          _react2.default.createElement(
            'span',
            { style: _DateTimeRangePicker.CUSTOM_DATE_RANGE_TEXT },
            'to'
          ),
          _react2.default.createElement(
            'div',
            { style: _DateTimeRangePicker.CUSTOM_DATE_CONTAINER },
            _react2.default.createElement(_DatePicker2.default, {
              isValid: checkValid,
              onChange: this._handleCustomEndDateChange,
              pattern: DATE_RANGE_FORMAT,
              validationText: ' ',
              value: customDateRangeEnd
            })
          ),
          _react2.default.createElement(
            'div',
            { style: _DateTimeRangePicker.BUTTON },
            _react2.default.createElement(
              _Button2.default,
              {
                disabled: !checkValid,
                onClick: this._applyCustomDateRange,
                variant: 'accent'
              },
              'Apply'
            )
          ),
          _react2.default.createElement(
            'div',
            null,
            _react2.default.createElement(
              _Button2.default,
              {
                onClick: this._cancelCustomDateRange,
                variant: 'plain',
                _style: BUTTON_CANCEL
              },
              'Cancel'
            )
          )
        );
      }

      return _react2.default.createElement(
        'div',
        { style: _DateTimeRangePicker.BUTTON_STYLE },
        _react2.default.createElement(_ButtonSelect2.default, {
          buttonText: selectedPreset.range,
          dropdownAttachmentLocation: 'left',
          items: this._getDateRangeOptions(),
          onButtonClick: this._togglePresets,
          onItemSelect: this._handlePresetSelect,
          open: open,
          value: selectedPreset.value
        }),
        buttonItems && buttonItems.map(function (item, index) {
          return _react2.default.createElement(
            'div',
            {
              className: 'actionButtons',
              key: index,
              style: _DateTimeRangePicker.BUTTON
            },
            item
          );
        })
      );
    }
  }, {
    key: 'render',
    value: function render() {
      var _state4 = this.state,
          customDateRangeStart = _state4.customDateRangeStart,
          customDateRangeEnd = _state4.customDateRangeEnd;


      return _react2.default.createElement(
        'div',
        { 'data-component': 'TxlDateRangePicker' },
        _react2.default.createElement(
          'div',
          { style: _DateTimeRangePicker.PRESET_CONTAINER },
          this._renderDateRangeOptions(),
          !this._isDateRangeValid(customDateRangeStart, customDateRangeEnd) && _react2.default.createElement(
            'div',
            { style: _DateTimeRangePicker.VALIDATION },
            _react2.default.createElement(
              'span',
              null,
              DATE_VALIDATION
            )
          )
        )
      );
    }
  }]);
  return TxlDateRangePicker;
}(_react2.default.Component), (_applyDecoratedDescriptor(_class2.prototype, '_isDateRangeValid', [_Base.autobind], (0, _getOwnPropertyDescriptor2.default)(_class2.prototype, '_isDateRangeValid'), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, '_togglePresets', [_Base.autobind], (0, _getOwnPropertyDescriptor2.default)(_class2.prototype, '_togglePresets'), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, '_handlePresetSelect', [_Base.autobind], (0, _getOwnPropertyDescriptor2.default)(_class2.prototype, '_handlePresetSelect'), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, '_checkPreset', [_Base.autobind], (0, _getOwnPropertyDescriptor2.default)(_class2.prototype, '_checkPreset'), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, '_cancelCustomDateRange', [_Base.autobind], (0, _getOwnPropertyDescriptor2.default)(_class2.prototype, '_cancelCustomDateRange'), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, '_applyCustomDateRange', [_Base.autobind], (0, _getOwnPropertyDescriptor2.default)(_class2.prototype, '_applyCustomDateRange'), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, '_getDateRangeOptions', [_Base.autobind], (0, _getOwnPropertyDescriptor2.default)(_class2.prototype, '_getDateRangeOptions'), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, '_handleCustomStartDateChange', [_Base.autobind], (0, _getOwnPropertyDescriptor2.default)(_class2.prototype, '_handleCustomStartDateChange'), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, '_handleCustomEndDateChange', [_Base.autobind], (0, _getOwnPropertyDescriptor2.default)(_class2.prototype, '_handleCustomEndDateChange'), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, '_updateChange', [_Base.autobind], (0, _getOwnPropertyDescriptor2.default)(_class2.prototype, '_updateChange'), _class2.prototype), _applyDecoratedDescriptor(_class2.prototype, '_renderDateRangeOptions', [_Base.autobind], (0, _getOwnPropertyDescriptor2.default)(_class2.prototype, '_renderDateRangeOptions'), _class2.prototype)), _class2)) || _class;

TxlDateRangePicker.propTypes = {
  buttonItems: require('react').PropTypes.arrayOf(require('react').PropTypes.any),
  items: require('react').PropTypes.object.isRequired,
  onChange: require('react').PropTypes.func.isRequired,
  open: require('react').PropTypes.bool.isRequired,
  presets: require('react').PropTypes.arrayOf(require('react').PropTypes.object),
  updateDropdown: require('react').PropTypes.func.isRequired
};
exports.default = TxlDateRangePicker;


TxlDateRangePicker.defaultProps = {
  items: {},
  onChange: _Base.NOOP,
  open: false,
  updateDropdown: _Base.NOOP
};

TxlDateRangePicker.contextTypes = {
  txlAppTheme: _theme.contextThemePropType
};
;

var _temp2 = function () {
  if (typeof __REACT_HOT_LOADER__ === 'undefined') {
    return;
  }

  __REACT_HOT_LOADER__.register(DATE_RANGE_FORMAT, 'DATE_RANGE_FORMAT', 'src/_date-time-range-picker/_DateRangePicker.jsx');

  __REACT_HOT_LOADER__.register(DATE_QUERY_FORMAT, 'DATE_QUERY_FORMAT', 'src/_date-time-range-picker/_DateRangePicker.jsx');

  __REACT_HOT_LOADER__.register(TIME_QUERY_FORMAT, 'TIME_QUERY_FORMAT', 'src/_date-time-range-picker/_DateRangePicker.jsx');

  __REACT_HOT_LOADER__.register(DATE_VALIDATION, 'DATE_VALIDATION', 'src/_date-time-range-picker/_DateRangePicker.jsx');

  __REACT_HOT_LOADER__.register(CUSTOM_PRESET_KEY, 'CUSTOM_PRESET_KEY', 'src/_date-time-range-picker/_DateRangePicker.jsx');

  __REACT_HOT_LOADER__.register(TxlDateRangePicker, 'TxlDateRangePicker', 'src/_date-time-range-picker/_DateRangePicker.jsx');
}();

;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9fZGF0ZS10aW1lLXJhbmdlLXBpY2tlci9fRGF0ZVJhbmdlUGlja2VyLmpzeCJdLCJuYW1lcyI6WyJEQVRFX1JBTkdFX0ZPUk1BVCIsIkRBVEVfUVVFUllfRk9STUFUIiwiVElNRV9RVUVSWV9GT1JNQVQiLCJEQVRFX1ZBTElEQVRJT04iLCJDVVNUT01fUFJFU0VUX0tFWSIsIlR4bERhdGVSYW5nZVBpY2tlciIsInN0YXRlIiwiY3VzdG9tRGF0ZVJhbmdlRW5kIiwicHJvcHMiLCJpdGVtcyIsImVuZERhdGVUaW1lIiwiZm9ybWF0IiwiY3VzdG9tRGF0ZVJhbmdlU3RhcnQiLCJzdGFydERhdGVUaW1lIiwicHJldmlvdXNQcmVzZXQiLCJwcmVzZXQiLCJzZWxlY3RlZERhdGVSYW5nZUVuZCIsInNlbGVjdGVkRGF0ZVJhbmdlU3RhcnQiLCJzZWxlY3RlZFByZXNldCIsInNob3dDdXN0b21EYXRlUGlja2VyIiwiX2NoZWNrUHJlc2V0IiwibmV4dFByb3BzIiwic2V0U3RhdGUiLCJzdGFydCIsImVuZCIsImRpZmYiLCJ1cGRhdGVEcm9wZG93biIsIm9wZW4iLCJpdGVtIiwiX3RvZ2dsZVByZXNldHMiLCJ2YWx1ZSIsIl91cGRhdGVDaGFuZ2UiLCJlbmREYXRlIiwic3RhcnREYXRlIiwicmFuZ2VEYXRlcyIsInJhbmdlIiwic3BsaXQiLCJpbmNsdWRlcyIsImZvcm1hdHRlZFN0YXJ0RGF0ZSIsImZvcm1hdHRlZEVuZERhdGUiLCJsYWJlbCIsInByZXNldHMiLCJtYXAiLCJrZXkiLCJkYXRlIiwib25DaGFuZ2UiLCJzdGFydFRpbWUiLCJlbmRUaW1lIiwiYnV0dG9uSXRlbXMiLCJDT0xPUl9BUFBfVEhFTUUiLCJjb250ZXh0IiwidHhsQXBwVGhlbWUiLCJCVVRUT05fQ0FOQ0VMIiwiY29sb3IiLCJjaGVja1ZhbGlkIiwiX2lzRGF0ZVJhbmdlVmFsaWQiLCJfaGFuZGxlQ3VzdG9tU3RhcnREYXRlQ2hhbmdlIiwiX2hhbmRsZUN1c3RvbUVuZERhdGVDaGFuZ2UiLCJfYXBwbHlDdXN0b21EYXRlUmFuZ2UiLCJfY2FuY2VsQ3VzdG9tRGF0ZVJhbmdlIiwiX2dldERhdGVSYW5nZU9wdGlvbnMiLCJfaGFuZGxlUHJlc2V0U2VsZWN0IiwiaW5kZXgiLCJfcmVuZGVyRGF0ZVJhbmdlT3B0aW9ucyIsIkNvbXBvbmVudCIsImRlZmF1bHRQcm9wcyIsImNvbnRleHRUeXBlcyJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQ0E7Ozs7QUFDQTs7OztBQUNBOzs7O0FBQ0E7Ozs7QUFFQTs7QUFJQTs7QUFTQTs7QUFDQTs7OztBQUNBOzs7O0FBQ0E7Ozs7QUFDQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBRUEsSUFBTUEsb0JBQW9CLElBQTFCO0FBQ0EsSUFBTUMsb0JBQW9CLFlBQTFCO0FBQ0EsSUFBTUMsb0JBQW9CLFVBQTFCO0FBQ0EsSUFBTUMsa0JBQWtCLG1EQUF4QjtBQUNBLElBQU1DLG9CQUFvQixRQUExQjs7UUFHRUosaUIsR0FBQUEsaUI7UUFDQUMsaUIsR0FBQUEsaUI7UUFDQUMsaUIsR0FBQUEsaUI7O0lBdUJtQkcsa0I7Ozs7Ozs7Ozs7Ozs7O29PQUVuQkMsSyxHQUFlO0FBQ2JDLDBCQUFvQixzQkFBTyxNQUFLQyxLQUFMLENBQVdDLEtBQVgsQ0FBaUJDLFdBQXhCLEVBQXFDQyxNQUFyQyxDQUE0Q1gsaUJBQTVDLENBRFA7QUFFYlksNEJBQXNCLHNCQUFPLE1BQUtKLEtBQUwsQ0FBV0MsS0FBWCxDQUFpQkksYUFBeEIsRUFBdUNGLE1BQXZDLENBQThDWCxpQkFBOUMsQ0FGVDtBQUdiYyxzQkFBZ0IsTUFBS04sS0FBTCxDQUFXQyxLQUFYLENBQWlCTSxNQUhwQjtBQUliQyw0QkFBc0Isc0JBQU8sTUFBS1IsS0FBTCxDQUFXQyxLQUFYLENBQWlCQyxXQUF4QixFQUFxQ0MsTUFBckMsQ0FBNENWLGlCQUE1QyxDQUpUO0FBS2JnQiw4QkFBd0Isc0JBQU8sTUFBS1QsS0FBTCxDQUFXQyxLQUFYLENB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Q0FDLGlCOztnQ0FDQUMsaUI7O2dDQUNBQyxlOztnQ0FDQUMsaUI7O2dDQTRCZUMsa0IiLCJmaWxlIjoiX0RhdGVSYW5nZVBpY2tlci5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8vIEBmbG93XG5pbXBvcnQgUmVhY3QgZnJvbSAncmVhY3QnO1xuaW1wb3J0IFJhZGl1bSBmcm9tICdyYWRpdW0nO1xuaW1wb3J0IG1vbWVudCBmcm9tICdtb21lbnQnO1xuaW1wb3J0IGlzRXF1YWwgZnJvbSAnbG9kYXNoL2lzRXF1YWwnO1xuXG5pbXBvcnQge1xuICBhdXRvYmluZCxcbiAgTk9PUCxcbn0gZnJvbSAnLi4vYmFzZS9CYXNlJztcbmltcG9ydCB7XG4gIEJVVFRPTixcbiAgQlVUVE9OX1NUWUxFLFxuICBDVVNUT01fREFURV9DT05UQUlORVIsXG4gIENVU1RPTV9EQVRFX1JBTkdFLFxuICBDVVNUT01fREFURV9SQU5HRV9URVhULFxuICBQUkVTRVRfQ09OVEFJTkVSLFxuICBWQUxJREFUSU9OLFxufSBmcm9tICcuL0RhdGVUaW1lUmFuZ2VQaWNrZXIuc3R5bGUnO1xuaW1wb3J0IHsgY29udGV4dFRoZW1lUHJvcFR5cGUsIGRldGVybWluZUNvbG9yQXBwVGhlbWUgfSBmcm9tICcuLi9zdHlsZXMvdGhlbWUnO1xuaW1wb3J0IEJ1dHRvbiBmcm9tICcuLi9idXR0b25zL0J1dHRvbic7XG5pbXBvcnQgQnV0dG9uU2VsZWN0IGZyb20gJy4uL2Ryb3Bkb3ducy9CdXR0b25TZWxlY3QnO1xuaW1wb3J0IERhdGVQaWNrZXIgZnJvbSAnLi4vaW5wdXQtZmllbGRzL0RhdGVQaWNrZXInO1xuaW1wb3J0IHsgREFURV9SQU5HRV9QUkVTRVRTIH0gZnJvbSAnLi9fRGF0ZVRpbWVDb25zdGFudHMnO1xuXG5jb25zdCBEQVRFX1JBTkdFX0ZPUk1BVCA9ICdsbCc7XG5jb25zdCBEQVRFX1FVRVJZX0ZPUk1BVCA9ICdZWVlZLU1NLUREJztcbmNvbnN0IFRJTUVfUVVFUllfRk9STUFUID0gJ0hIOm1tOnNzJztcbmNvbnN0IERBVEVfVkFMSURBVElPTiA9ICdQbGVhc2Ugc2VsZWN0IGEgZGF0ZSByYW5nZSBpbiBjaHJvbm9sb2dpY2FsIG9yZGVyJztcbmNvbnN0IENVU1RPTV9QUkVTRVRfS0VZID0gJ2N1c3RvbSc7XG5cbmV4cG9ydCB7XG4gIERBVEVfUkFOR0VfRk9STUFULFxuICBEQVRFX1FVRVJZX0ZPUk1BVCxcbiAgVElNRV9RVUVSWV9GT1JNQVQsXG59O1xuXG50eXBlIFByb3BzID0ge1xuICBidXR0b25JdGVtcz86IEFycmF5PG1peGVkPixcbiAgaXRlbXM6IE9iamVjdCxcbiAgb25DaGFuZ2U6IChzdGF0dXM6IE9iamVjdCkgPT4gdm9pZCxcbiAgb3BlbjogYm9vbGVhbixcbiAgcHJlc2V0cz86IEFycmF5PE9iamVjdD4sXG4gIHVwZGF0ZURyb3Bkb3duOiAoc3RhdHVzOiBPYmplY3QpID0+IHZvaWQsXG59O1xuXG50eXBlIFN0YXRlID0ge1xuICBjdXN0b21EYXRlUmFuZ2VTdGFydDogU3RyaW5nLFxuICBjdXN0b21EYXRlUmFuZ2VFbmQ6IFN0cmluZyxcbiAgcHJldmlvdXNQcmVzZXQ6IE9iamVjdCxcbiAgc2VsZWN0ZWREYXRlUmFuZ2VTdGFydDogU3RyaW5nLFxuICBzZWxlY3RlZERhdGVSYW5nZUVuZDogU3RyaW5nLFxuICBzZWxlY3RlZFByZXNldDogT2JqZWN0LFxuICBzaG93Q3VzdG9tRGF0ZVBpY2tlcjogYm9vbGVhbixcbn07XG5cbkBSYWRpdW1cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFR4bERhdGVSYW5nZVBpY2tlciBleHRlbmRzIFJlYWN0LkNvbXBvbmVudCB7XG4gIHByb3BzOiBQcm9wcztcbiAgc3RhdGU6IFN0YXRlID0ge1xuICAgIGN1c3RvbURhdGVSYW5nZUVuZDogbW9tZW50KHRoaXMucHJvcHMuaXRlbXMuZW5kRGF0ZVRpbWUpLmZvcm1hdChEQVRFX1JBTkdFX0ZPUk1BVCksXG4gICAgY3VzdG9tRGF0ZVJhbmdlU3RhcnQ6IG1vbWVudCh0aGlzLnByb3BzLml0ZW1zLnN0YXJ0RGF0ZVRpbWUpLmZvcm1hdChEQVRFX1JBTkdFX0ZPUk1BVCksXG4gICAgcHJldmlvdXNQcmVzZXQ6IHRoaXMucHJvcHMuaXRlbXMucHJlc2V0LFxuICAgIHNlbGVjdGVkRGF0ZVJhbmdlRW5kOiBtb21lbnQodGhpcy5wcm9wcy5pdGVtcy5lbmREYXRlVGltZSkuZm9ybWF0KERBVEVfUVVFUllfRk9STUFUKSxcbiAgICBzZWxlY3RlZERhdGVSYW5nZVN0YXJ0OiBtb21lbnQodGhpcy5wcm9wcy5pdGVtcy5zdGFydERhdGVUaW1lKS5mb3JtYXQoREFURV9RVUVSWV9GT1JNQVQpLFxuICAgIHNlbGVjdGVkUHJlc2V0OiB0aGlzLnByb3BzLml0ZW1zLnByZXNldCxcbiAgICBzaG93Q3VzdG9tRGF0ZVBpY2tlcjogZmFsc2UsXG4gIH07XG5cbiAgY29tcG9uZW50RGlkTW91bnQoKSB7XG4gICAgdGhpcy5fY2hlY2tQcmVzZXQoKTtcbiAgfVxuXG4gIGNvbXBvbmVudFdpbGxSZWNlaXZlUHJvcHMobmV4dFByb3BzOiBPYmplY3QpIHtcbiAgICBpZiAoIWlzRXF1YWwodGhpcy5wcm9wcywgbmV4dFByb3BzKSkge1xuICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgIGN1c3RvbURhdGVSYW5nZUVuZDogbW9tZW50KG5leHRQcm9wcy5pdGVtcy5lbmREYXRlVGltZSkuZm9ybWF0KERBVEVfUkFOR0VfRk9STUFUKSxcbiAgICAgICAgY3VzdG9tRGF0ZVJhbmdlU3RhcnQ6IG1vbWVudChuZXh0UHJvcHMuaXRlbXMuc3RhcnREYXRlVGltZSkuZm9ybWF0KERBVEVfUkFOR0VfRk9STUFUKSxcbiAgICAgICAgcHJldmlvdXNQcmVzZXQ6IHRoaXMucHJvcHMuaXRlbXMucHJlc2V0LFxuICAgICAgICBzZWxlY3RlZERhdGVSYW5nZUVuZDogbW9tZW50KG5leHRQcm9wcy5pdGVtcy5lbmREYXRlVGltZSkuZm9ybWF0KERBVEVfUVVFUllfRk9STUFUKSxcbiAgICAgICAgc2VsZWN0ZWREYXRlUmFuZ2VTdGFydDogbW9tZW50KG5leHRQcm9wcy5pdGVtcy5zdGFydERhdGVUaW1lKS5mb3JtYXQoREFURV9RVUVSWV9GT1JNQVQpLFxuICAgICAgICBzZWxlY3RlZFByZXNldDogbmV4dFByb3BzLml0ZW1zLnByZXNldCxcbiAgICAgIH0sIHRoaXMuX2NoZWNrUHJlc2V0KTtcbiAgICB9XG4gIH1cblxuXG4gIEBhdXRvYmluZFxuICBfaXNEYXRlUmFuZ2VWYWxpZChzdGFydDogc3RyaW5nLCBlbmQ6IHN0cmluZykge1xuICAgIHJldHVybiBtb21lbnQoZW5kLCBEQVRFX1JBTkdFX0ZPUk1BVCkuZGlmZihtb21lbnQoc3RhcnQsIERBVEVfUkFOR0VfRk9STUFUKSkgPj0gMDtcbiAgfVxuXG4gIEBhdXRvYmluZFxuICBfdG9nZ2xlUHJlc2V0cygpIHtcbiAgICB0aGlzLnByb3BzLnVwZGF0ZURyb3Bkb3duKHsgb3BlbjogIXRoaXMucHJvcHMub3BlbiB9KTtcbiAgfVxuXG4gIEBhdXRvYmluZFxuICBfaGFuZGxlUHJlc2V0U2VsZWN0KGl0ZW06IE9iamVjdCkge1xuICAgIGNvbnN0IHsgc2VsZWN0ZWRQcmVzZXQgfSA9IHRoaXMuc3RhdGU7XG5cbiAgICB0aGlzLl90b2dnbGVQcmVzZXRzKCk7XG5cbiAgICBpZiAoaXRlbS52YWx1ZSA9PT0gJ2N1c3RvbScpIHtcbiAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICBwcmV2aW91c1ByZXNldDogc2VsZWN0ZWRQcmVzZXQsXG4gICAgICAgIHNlbGVjdGVkUHJlc2V0OiBpdGVtLFxuICAgICAgICBzaG93Q3VzdG9tRGF0ZVBpY2tlcjogdHJ1ZSxcbiAgICAgIH0sIHRoaXMuX3VwZGF0ZUNoYW5nZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICBzaG93Q3VzdG9tRGF0ZVBpY2tlcjogdHJ1ZSxcbiAgICAgIH0sICgpID0+IHtcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgY3VzdG9tRGF0ZVJhbmdlRW5kOiBpdGVtLmVuZERhdGUuZm9ybWF0KERBVEVfUkFOR0VfRk9STUFUKSxcbiAgICAgICAgICBjdXN0b21EYXRlUmFuZ2VTdGFydDogaXRlbS5zdGFydERhdGUuZm9ybWF0KERBVEVfUkFOR0VfRk9STUFUKSxcbiAgICAgICAgICBwcmV2aW91c1ByZXNldDogc2VsZWN0ZWRQcmVzZXQsXG4gICAgICAgICAgc2VsZWN0ZWREYXRlUmFuZ2VFbmQ6IGl0ZW0uZW5kRGF0ZS5mb3JtYXQoREFURV9RVUVSWV9GT1JNQVQpLFxuICAgICAgICAgIHNlbGVjdGVkRGF0ZVJhbmdlU3RhcnQ6IGl0ZW0uc3RhcnREYXRlLmZvcm1hdChEQVRFX1FVRVJZX0ZPUk1BVCksXG4gICAgICAgICAgc2VsZWN0ZWRQcmVzZXQ6IGl0ZW0sXG4gICAgICAgICAgc2hvd0N1c3RvbURhdGVQaWNrZXI6IGZhbHNlLFxuICAgICAgICB9LCAoKSA9PiB7XG4gICAgICAgICAgdGhpcy5fY2hlY2tQcmVzZXQoKTtcbiAgICAgICAgICB0aGlzLl91cGRhdGVDaGFuZ2UoKTtcbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICB9XG4gIH1cblxuICBAYXV0b2JpbmRcbiAgX2NoZWNrUHJlc2V0KCkge1xuICAgIGNvbnN0IHsgc2VsZWN0ZWRQcmVzZXQgfSA9IHRoaXMuc3RhdGU7XG4gICAgY29uc3QgcmFuZ2VEYXRlcyA9IHNlbGVjdGVkUHJlc2V0LnJhbmdlLnNwbGl0KCcgLSAnKTtcbiAgICBpZiAocmFuZ2VEYXRlc1swXSA9PT0gcmFuZ2VEYXRlc1sxXSkge1xuICAgICAgc2VsZWN0ZWRQcmVzZXQucmFuZ2UgPSByYW5nZURhdGVzWzBdO1xuICAgICAgdGhpcy5zZXRTdGF0ZSh7IHNlbGVjdGVkUHJlc2V0IH0pO1xuICAgIH1cbiAgfVxuXG4gIEBhdXRvYmluZFxuICBfY2FuY2VsQ3VzdG9tRGF0ZVJhbmdlKCkge1xuICAgIGNvbnN0IHByZXNldCA9IHRoaXMuc3RhdGUucHJldmlvdXNQcmVzZXQ7XG4gICAgaWYgKCFwcmVzZXQucmFuZ2UuaW5jbHVkZXMoJy0nKSkge1xuICAgICAgcHJlc2V0LnJhbmdlID0gYCR7cHJlc2V0LnJhbmdlfSAtICR7cHJlc2V0LnJhbmdlfWA7XG4gICAgfVxuXG4gICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICBjdXN0b21EYXRlUmFuZ2VFbmQ6IG1vbWVudCh0aGlzLnN0YXRlLnNlbGVjdGVkRGF0ZVJhbmdlRW5kKS5mb3JtYXQoREFURV9SQU5HRV9GT1JNQVQpLFxuICAgICAgY3VzdG9tRGF0ZVJhbmdlU3RhcnQ6IG1vbWVudCh0aGlzLnN0YXRlLnNlbGVjdGVkRGF0ZVJhbmdlU3RhcnQpLmZvcm1hdChEQVRFX1JBTkdFX0ZPUk1BVCksXG4gICAgICBzZWxlY3RlZFByZXNldDogcHJlc2V0LFxuICAgICAgc2hvd0N1c3RvbURhdGVQaWNrZXI6ICF0aGlzLnN0YXRlLnNob3dDdXN0b21EYXRlUGlja2VyLFxuICAgIH0sIHRoaXMuX2NoZWNrUHJlc2V0KTtcbiAgfVxuXG4gIEBhdXRvYmluZFxuICBfYXBwbHlDdXN0b21EYXRlUmFuZ2UoKSB7XG4gICAgY29uc3Qge1xuICAgICAgY3VzdG9tRGF0ZVJhbmdlU3RhcnQsXG4gICAgICBjdXN0b21EYXRlUmFuZ2VFbmQsXG4gICAgICBzaG93Q3VzdG9tRGF0ZVBpY2tlcixcbiAgICB9ID0gdGhpcy5zdGF0ZTtcblxuICAgIGNvbnN0IHN0YXJ0RGF0ZSA9IG1vbWVudChjdXN0b21EYXRlUmFuZ2VTdGFydCwgREFURV9SQU5HRV9GT1JNQVQpO1xuICAgIGNvbnN0IGVuZERhdGUgPSBtb21lbnQoY3VzdG9tRGF0ZVJhbmdlRW5kLCBEQVRFX1JBTkdFX0ZPUk1BVCk7XG4gICAgY29uc3QgZm9ybWF0dGVkU3RhcnREYXRlID0gc3RhcnREYXRlLmZvcm1hdChEQVRFX1JBTkdFX0ZPUk1BVCk7XG4gICAgY29uc3QgZm9ybWF0dGVkRW5kRGF0ZSA9IGVuZERhdGUuZm9ybWF0KERBVEVfUkFOR0VfRk9STUFUKTtcblxuICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgc2VsZWN0ZWREYXRlUmFuZ2VFbmQ6IGVuZERhdGUuZm9ybWF0KERBVEVfUVVFUllfRk9STUFUKSxcbiAgICAgIHNlbGVjdGVkRGF0ZVJhbmdlU3RhcnQ6IHN0YXJ0RGF0ZS5mb3JtYXQoREFURV9RVUVSWV9GT1JNQVQpLFxuICAgIH0sICgpID0+IHtcbiAgICAgIC8vIFRPRE86IGZpbmQgYW5vdGhlciB3YXkgdG8gc2V0IHByZXNldCBieSB1c2luZyBzdGF0ZS5zZWxlY3RlZFByZXNldFxuICAgICAgY29uc3QgcHJlc2V0ID0ge1xuICAgICAgICBlbmREYXRlLFxuICAgICAgICBsYWJlbDogJ0N1c3RvbSBkYXRlIHJhbmdlJyxcbiAgICAgICAgcmFuZ2U6IGAke2Zvcm1hdHRlZFN0YXJ0RGF0ZX0gLSAke2Zvcm1hdHRlZEVuZERhdGV9YCxcbiAgICAgICAgc3RhcnREYXRlLFxuICAgICAgICB2YWx1ZTogJ2N1c3RvbScsXG4gICAgICB9O1xuICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgIHNlbGVjdGVkUHJlc2V0OiBwcmVzZXQsXG4gICAgICAgIHNob3dDdXN0b21EYXRlUGlja2VyOiAhc2hvd0N1c3RvbURhdGVQaWNrZXIsXG4gICAgICB9LCB0aGlzLl91cGRhdGVDaGFuZ2UpO1xuICAgIH0pO1xuICB9XG5cbiAgQGF1dG9iaW5kXG4gIF9nZXREYXRlUmFuZ2VPcHRpb25zKCkge1xuICAgIHJldHVybiAodGhpcy5wcm9wcy5wcmVzZXRzIHx8IERBVEVfUkFOR0VfUFJFU0VUUygpKS5tYXAoKHByZXNldCkgPT4ge1xuICAgICAgbGV0IHN0YXJ0RGF0ZSA9IG1vbWVudChwcmVzZXQuc3RhcnREYXRlKS5mb3JtYXQoREFURV9SQU5HRV9GT1JNQVQpO1xuICAgICAgbGV0IGVuZERhdGUgPSBtb21lbnQocHJlc2V0LmVuZERhdGUpLmZvcm1hdChEQVRFX1JBTkdFX0ZPUk1BVCk7XG4gICAgICBpZiAocHJlc2V0LmtleSA9PT0gQ1VTVE9NX1BSRVNFVF9LRVkgJiYgdGhpcy5zdGF0ZSkge1xuICAgICAgICBzdGFydERhdGUgPSBtb21lbnQodGhpcy5zdGF0ZS5zZWxlY3RlZERhdGVSYW5nZVN0YXJ0KS5mb3JtYXQoREFURV9SQU5HRV9GT1JNQVQpO1xuICAgICAgICBlbmREYXRlID0gbW9tZW50KHRoaXMuc3RhdGUuc2VsZWN0ZWREYXRlUmFuZ2VFbmQpLmZvcm1hdChEQVRFX1JBTkdFX0ZPUk1BVCk7XG4gICAgICB9XG4gICAgICByZXR1cm4gKHtcbiAgICAgICAgZW5kRGF0ZTogbW9tZW50KGVuZERhdGUsIERBVEVfUkFOR0VfRk9STUFUKSxcbiAgICAgICAgbGFiZWw6IHByZXNldC5sYWJlbCxcbiAgICAgICAgcmFuZ2U6IGAke3N0YXJ0RGF0ZX0gLSAke2VuZERhdGV9YCxcbiAgICAgICAgc3RhcnREYXRlOiBtb21lbnQoc3RhcnREYXRlLCBEQVRFX1JBTkdFX0ZPUk1BVCksXG4gICAgICAgIHZhbHVlOiBwcmVzZXQua2V5LFxuICAgICAgfSk7XG4gICAgfSk7XG4gIH1cblxuICBAYXV0b2JpbmRcbiAgX2hhbmRsZUN1c3RvbVN0YXJ0RGF0ZUNoYW5nZShkYXRlOiBPYmplY3QpIHtcbiAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgIGN1c3RvbURhdGVSYW5nZVN0YXJ0OiBtb21lbnQoZGF0ZS52YWx1ZSwgREFURV9SQU5HRV9GT1JNQVQpLmZvcm1hdChEQVRFX1JBTkdFX0ZPUk1BVCksXG4gICAgfSk7XG4gIH1cblxuICBAYXV0b2JpbmRcbiAgX2hhbmRsZUN1c3RvbUVuZERhdGVDaGFuZ2UoZGF0ZTogT2JqZWN0KSB7XG4gICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICBjdXN0b21EYXRlUmFuZ2VFbmQ6IG1vbWVudChkYXRlLnZhbHVlLCBEQVRFX1JBTkdFX0ZPUk1BVCkuZm9ybWF0KERBVEVfUkFOR0VfRk9STUFUKSxcbiAgICB9KTtcbiAgfVxuXG4gIEBhdXRvYmluZFxuICBfdXBkYXRlQ2hhbmdlKCkge1xuICAgIGNvbnN0IHtcbiAgICAgIHNlbGVjdGVkRGF0ZVJhbmdlU3RhcnQsXG4gICAgICBzZWxlY3RlZERhdGVSYW5nZUVuZCxcbiAgICAgIHNlbGVjdGVkUHJlc2V0LFxuICAgIH0gPSB0aGlzLnN0YXRlO1xuICAgIGNvbnN0IHtcbiAgICAgIGl0ZW1zLFxuICAgICAgb25DaGFuZ2UsXG4gICAgfSA9IHRoaXMucHJvcHM7XG4gICAgY29uc3Qgc3RhcnRUaW1lID0gbW9tZW50KGl0ZW1zLnN0YXJ0RGF0ZVRpbWUpLmZvcm1hdChUSU1FX1FVRVJZX0ZPUk1BVCk7XG4gICAgY29uc3QgZW5kVGltZSA9IG1vbWVudChpdGVtcy5lbmREYXRlVGltZSkuZm9ybWF0KFRJTUVfUVVFUllfRk9STUFUKTtcbiAgICBpdGVtcy5wcmVzZXQgPSBzZWxlY3RlZFByZXNldDtcbiAgICBpdGVtcy5zdGFydERhdGVUaW1lID0gYCR7c2VsZWN0ZWREYXRlUmFuZ2VTdGFydH0gJHtzdGFydFRpbWV9YDtcbiAgICBpdGVtcy5lbmREYXRlVGltZSA9IGAke3NlbGVjdGVkRGF0ZVJhbmdlRW5kfSAke2VuZFRpbWV9YDtcbiAgICBvbkNoYW5nZShpdGVtcyk7XG4gIH1cblxuICBAYXV0b2JpbmRcbiAgX3JlbmRlckRhdGVSYW5nZU9wdGlvbnMoKSB7XG4gICAgY29uc3Qge1xuICAgICAgY3VzdG9tRGF0ZVJhbmdlU3RhcnQsXG4gICAgICBjdXN0b21EYXRlUmFuZ2VFbmQsXG4gICAgICBzZWxlY3RlZFByZXNldCxcbiAgICAgIHNob3dDdXN0b21EYXRlUGlja2VyLFxuICAgIH0gPSB0aGlzLnN0YXRlO1xuXG4gICAgY29uc3Qge1xuICAgICAgYnV0dG9uSXRlbXMsXG4gICAgICBvcGVuLFxuICAgIH0gPSB0aGlzLnByb3BzO1xuXG4gICAgY29uc3QgQ09MT1JfQVBQX1RIRU1FID0gZGV0ZXJtaW5lQ29sb3JBcHBUaGVtZSh0aGlzLmNvbnRleHQudHhsQXBwVGhlbWUpO1xuICAgIGNvbnN0IEJVVFRPTl9DQU5DRUwgPSB7XG4gICAgICBjb2xvcjogQ09MT1JfQVBQX1RIRU1FWyc1MDAnXSxcbiAgICB9O1xuXG4gICAgaWYgKHNob3dDdXN0b21EYXRlUGlja2VyKSB7XG4gICAgICBjb25zdCBjaGVja1ZhbGlkID0gdGhpcy5faXNEYXRlUmFuZ2VWYWxpZChjdXN0b21EYXRlUmFuZ2VTdGFydCwgY3VzdG9tRGF0ZVJhbmdlRW5kKTtcblxuICAgICAgcmV0dXJuIChcbiAgICAgICAgPGRpdiBzdHlsZT17Q1VTVE9NX0RBVEVfUkFOR0V9PlxuICAgICAgICAgIDxkaXYgc3R5bGU9e0NVU1RPTV9EQVRFX0NPTlRBSU5FUn0+XG4gICAgICAgICAgICA8RGF0ZVBpY2tlclxuICAgICAgICAgICAgICBpc1ZhbGlkPXtjaGVja1ZhbGlkfVxuICAgICAgICAgICAgICBvbkNoYW5nZT17dGhpcy5faGFuZGxlQ3VzdG9tU3RhcnREYXRlQ2hhbmdlfVxuICAgICAgICAgICAgICBwYXR0ZXJuPXtEQVRFX1JBTkdFX0ZPUk1BVH1cbiAgICAgICAgICAgICAgdmFsaWRhdGlvblRleHQ9XCIgXCJcbiAgICAgICAgICAgICAgdmFsdWU9e2N1c3RvbURhdGVSYW5nZVN0YXJ0fVxuICAgICAgICAgICAgLz5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICA8c3BhbiBzdHlsZT17Q1VTVE9NX0RBVEVfUkFOR0VfVEVYVH0+dG88L3NwYW4+XG4gICAgICAgICAgPGRpdiBzdHlsZT17Q1VTVE9NX0RBVEVfQ09OVEFJTkVSfT5cbiAgICAgICAgICAgIDxEYXRlUGlja2VyXG4gICAgICAgICAgICAgIGlzVmFsaWQ9e2NoZWNrVmFsaWR9XG4gICAgICAgICAgICAgIG9uQ2hhbmdlPXt0aGlzLl9oYW5kbGVDdXN0b21FbmREYXRlQ2hhbmdlfVxuICAgICAgICAgICAgICBwYXR0ZXJuPXtEQVRFX1JBTkdFX0ZPUk1BVH1cbiAgICAgICAgICAgICAgdmFsaWRhdGlvblRleHQ9XCIgXCJcbiAgICAgICAgICAgICAgdmFsdWU9e2N1c3RvbURhdGVSYW5nZUVuZH1cbiAgICAgICAgICAgIC8+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgPGRpdiBzdHlsZT17QlVUVE9OfT5cbiAgICAgICAgICAgIDxCdXR0b25cbiAgICAgICAgICAgICAgZGlzYWJsZWQ9eyFjaGVja1ZhbGlkfVxuICAgICAgICAgICAgICBvbkNsaWNrPXt0aGlzLl9hcHBseUN1c3RvbURhdGVSYW5nZX1cbiAgICAgICAgICAgICAgdmFyaWFudD1cImFjY2VudFwiXG4gICAgICAgICAgICA+XG4gICAgICAgICAgICAgIEFwcGx5XG4gICAgICAgICAgICA8L0J1dHRvbj5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICA8ZGl2PlxuICAgICAgICAgICAgPEJ1dHRvblxuICAgICAgICAgICAgICBvbkNsaWNrPXt0aGlzLl9jYW5jZWxDdXN0b21EYXRlUmFuZ2V9XG4gICAgICAgICAgICAgIHZhcmlhbnQ9XCJwbGFpblwiXG4gICAgICAgICAgICAgIF9zdHlsZT17QlVUVE9OX0NBTkNFTH1cbiAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgQ2FuY2VsXG4gICAgICAgICAgICA8L0J1dHRvbj5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgPC9kaXY+XG4gICAgICApO1xuICAgIH1cblxuICAgIHJldHVybiAoXG4gICAgICA8ZGl2IHN0eWxlPXtCVVRUT05fU1RZTEV9PlxuICAgICAgICA8QnV0dG9uU2VsZWN0XG4gICAgICAgICAgYnV0dG9uVGV4dD17c2VsZWN0ZWRQcmVzZXQucmFuZ2V9XG4gICAgICAgICAgZHJvcGRvd25BdHRhY2htZW50TG9jYXRpb249XCJsZWZ0XCJcbiAgICAgICAgICBpdGVtcz17dGhpcy5fZ2V0RGF0ZVJhbmdlT3B0aW9ucygpfVxuICAgICAgICAgIG9uQnV0dG9uQ2xpY2s9e3RoaXMuX3RvZ2dsZVByZXNldHN9XG4gICAgICAgICAgb25JdGVtU2VsZWN0PXt0aGlzLl9oYW5kbGVQcmVzZXRTZWxlY3R9XG4gICAgICAgICAgb3Blbj17b3Blbn1cbiAgICAgICAgICB2YWx1ZT17c2VsZWN0ZWRQcmVzZXQudmFsdWV9XG4gICAgICAgIC8+XG4gICAgICAgIHtidXR0b25JdGVtcyAmJiBidXR0b25JdGVtcy5tYXAoKGl0ZW0sIGluZGV4KSA9PiAoXG4gICAgICAgICAgPGRpdlxuICAgICAgICAgICAgY2xhc3NOYW1lPVwiYWN0aW9uQnV0dG9uc1wiXG4gICAgICAgICAgICBrZXk9e2luZGV4fVxuICAgICAgICAgICAgc3R5bGU9e0JVVFRPTn1cbiAgICAgICAgICA+XG4gICAgICAgICAgICB7aXRlbX1cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgKSl9XG4gICAgICA8L2Rpdj5cbiAgICApO1xuICB9XG5cbiAgcmVuZGVyKCkge1xuICAgIGNvbnN0IHtcbiAgICAgIGN1c3RvbURhdGVSYW5nZVN0YXJ0LFxuICAgICAgY3VzdG9tRGF0ZVJhbmdlRW5kLFxuICAgIH0gPSB0aGlzLnN0YXRlO1xuXG4gICAgcmV0dXJuIChcbiAgICAgIDxkaXYgZGF0YS1jb21wb25lbnQ9XCJUeGxEYXRlUmFuZ2VQaWNrZXJcIj5cbiAgICAgICAgPGRpdiBzdHlsZT17UFJFU0VUX0NPTlRBSU5FUn0+XG4gICAgICAgICAge3RoaXMuX3JlbmRlckRhdGVSYW5nZU9wdGlvbnMoKX1cbiAgICAgICAgICB7IXRoaXMuX2lzRGF0ZVJhbmdlVmFsaWQoY3VzdG9tRGF0ZVJhbmdlU3RhcnQsIGN1c3RvbURhdGVSYW5nZUVuZCkgJiZcbiAgICAgICAgICAgIDxkaXYgc3R5bGU9e1ZBTElEQVRJT059PlxuICAgICAgICAgICAgICA8c3Bhbj5cbiAgICAgICAgICAgICAgICB7REFURV9WQUxJREFUSU9OfVxuICAgICAgICAgICAgICA8L3NwYW4+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICB9XG4gICAgICAgIDwvZGl2PlxuICAgICAgPC9kaXY+XG4gICAgKTtcbiAgfVxufVxuXG5UeGxEYXRlUmFuZ2VQaWNrZXIuZGVmYXVsdFByb3BzID0ge1xuICBpdGVtczoge30sXG4gIG9uQ2hhbmdlOiBOT09QLFxuICBvcGVuOiBmYWxzZSxcbiAgdXBkYXRlRHJvcGRvd246IE5PT1AsXG59O1xuXG5UeGxEYXRlUmFuZ2VQaWNrZXIuY29udGV4dFR5cGVzID0ge1xuICB0eGxBcHBUaGVtZTogY29udGV4dFRoZW1lUHJvcFR5cGUsXG59O1xuIl19