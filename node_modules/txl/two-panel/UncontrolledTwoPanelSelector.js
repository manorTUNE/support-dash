'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});

var _getOwnPropertyDescriptor = require('babel-runtime/core-js/object/get-own-property-descriptor');

var _getOwnPropertyDescriptor2 = _interopRequireDefault(_getOwnPropertyDescriptor);

var _extends2 = require('babel-runtime/helpers/extends');

var _extends3 = _interopRequireDefault(_extends2);

var _objectWithoutProperties2 = require('babel-runtime/helpers/objectWithoutProperties');

var _objectWithoutProperties3 = _interopRequireDefault(_objectWithoutProperties2);

var _getPrototypeOf = require('babel-runtime/core-js/object/get-prototype-of');

var _getPrototypeOf2 = _interopRequireDefault(_getPrototypeOf);

var _classCallCheck2 = require('babel-runtime/helpers/classCallCheck');

var _classCallCheck3 = _interopRequireDefault(_classCallCheck2);

var _createClass2 = require('babel-runtime/helpers/createClass');

var _createClass3 = _interopRequireDefault(_createClass2);

var _possibleConstructorReturn2 = require('babel-runtime/helpers/possibleConstructorReturn');

var _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);

var _inherits2 = require('babel-runtime/helpers/inherits');

var _inherits3 = _interopRequireDefault(_inherits2);

var _desc, _value, _class;

var _react = require('react');

var _react2 = _interopRequireDefault(_react);

var _debounce = require('lodash/debounce');

var _debounce2 = _interopRequireDefault(_debounce);

var _Base = require('../base/Base');

var _propTypes = require('../utils/propTypes');

var _propTypes2 = _interopRequireDefault(_propTypes);

var _TwoPanelSelector = require('./TwoPanelSelector');

var _TwoPanelSelector2 = _interopRequireDefault(_TwoPanelSelector);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _applyDecoratedDescriptor(target, property, decorators, descriptor, context) {
  var desc = {};
  Object['ke' + 'ys'](descriptor).forEach(function (key) {
    desc[key] = descriptor[key];
  });
  desc.enumerable = !!desc.enumerable;
  desc.configurable = !!desc.configurable;

  if ('value' in desc || desc.initializer) {
    desc.writable = true;
  }

  desc = decorators.slice().reverse().reduce(function (desc, decorator) {
    return decorator(target, property, desc) || desc;
  }, desc);

  if (context && desc.initializer !== void 0) {
    desc.value = desc.initializer ? desc.initializer.call(context) : void 0;
    desc.initializer = undefined;
  }

  if (desc.initializer === void 0) {
    Object['define' + 'Property'](target, property, desc);
    desc = null;
  }

  return desc;
}

var UncontrolledTwoPanelSelector = (_class = function (_React$Component) {
  (0, _inherits3.default)(UncontrolledTwoPanelSelector, _React$Component);

  function UncontrolledTwoPanelSelector() {
    var _ref;

    (0, _classCallCheck3.default)(this, UncontrolledTwoPanelSelector);

    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var _this = (0, _possibleConstructorReturn3.default)(this, (_ref = UncontrolledTwoPanelSelector.__proto__ || (0, _getPrototypeOf2.default)(UncontrolledTwoPanelSelector)).call.apply(_ref, [this].concat(args)));

    _this.state = {
      filteredItems: _this.props.items,
      searchValue: null
    };
    _this._filterItems = (0, _debounce2.default)(_this._filterItems, 300).bind(_this);
    return _this;
  }

  (0, _createClass3.default)(UncontrolledTwoPanelSelector, [{
    key: '_filterItems',
    value: function _filterItems(value) {
      var _this2 = this;

      var items = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : this.props.items;

      var newItems = void 0;

      if (!value) {
        newItems = items;
      } else {
        newItems = items.filter(function (item) {
          return _this2.props.filterFunction(item.searchContent, value);
        });
      }

      this.setState({
        filteredItems: newItems
      });

      return newItems;
    }
  }, {
    key: 'componentWillReceiveProps',
    value: function componentWillReceiveProps(nextProps) {
      if (this.props.items !== nextProps.items) {
        this._filterItems(this.state.searchValue);
      }
    }
  }, {
    key: '_handleSearchChange',
    value: function _handleSearchChange(_ref2) {
      var value = _ref2.value;

      if (!value) {
        this._handleSearchClear();
      } else {
        this._filterItems(value);

        this.setState({
          searchValue: value
        });

        this.props.onSearchChange({ value: value });
      }
    }
  }, {
    key: '_handleSearchClear',
    value: function _handleSearchClear() {
      this.setState({
        filteredItems: this.props.items,
        searchValue: null
      });
    }
  }, {
    key: '_handleItemSelect',
    value: function _handleItemSelect(obj) {
      this.setState({
        selectedValue: obj.value
      });
      this.props.onItemClick(obj);
    }
  }, {
    key: 'render',
    value: function render() {
      var _props = this.props,
          header = _props.header,
          contentLoading = _props.contentLoading,
          content = _props.content,
          itemListWidth = _props.itemListWidth,
          items = _props.items,
          visibleItems = _props.visibleItems,
          props = (0, _objectWithoutProperties3.default)(_props, ['header', 'contentLoading', 'content', 'itemListWidth', 'items', 'visibleItems']);
      var _state = this.state,
          selectedValue = _state.selectedValue,
          searchValue = _state.searchValue,
          filteredItems = _state.filteredItems;


      var shouldShowSearch = items.length > visibleItems;

      return _react2.default.createElement(_TwoPanelSelector2.default, (0, _extends3.default)({}, props, {
        contentLoading: contentLoading || false,
        content: content,
        header: header,
        itemListWidth: itemListWidth,
        items: filteredItems,
        onItemClick: this._handleItemSelect,
        onSearchChange: this._handleSearchChange,
        onSearchClear: this._handleSearchClear,
        onSearchSubmit: _Base.NOOP,
        searchValue: searchValue,
        selectedValue: selectedValue,
        shouldShowSearch: shouldShowSearch,
        visibleItemsCount: visibleItems
      }));
    }
  }]);
  return UncontrolledTwoPanelSelector;
}(_react2.default.Component), (_applyDecoratedDescriptor(_class.prototype, '_handleSearchChange', [_Base.autobind], (0, _getOwnPropertyDescriptor2.default)(_class.prototype, '_handleSearchChange'), _class.prototype), _applyDecoratedDescriptor(_class.prototype, '_handleSearchClear', [_Base.autobind], (0, _getOwnPropertyDescriptor2.default)(_class.prototype, '_handleSearchClear'), _class.prototype), _applyDecoratedDescriptor(_class.prototype, '_handleItemSelect', [_Base.autobind], (0, _getOwnPropertyDescriptor2.default)(_class.prototype, '_handleItemSelect'), _class.prototype)), _class);


UncontrolledTwoPanelSelector.defaultProps = {
  contentLoading: false,
  filterFunction: function filterFunction(value, searchValue) {
    return new RegExp(searchValue, 'i').test(value);
  },
  itemListWidth: '50%',
  itemsLoading: false,
  onSearchChange: _Base.NOOP,
  placeholderContent: null,
  visibleItems: 12
};

UncontrolledTwoPanelSelector.propTypes = {
  content: _TwoPanelSelector2.default.propTypes.content,
  contentLoading: _TwoPanelSelector2.default.propTypes.contentLoading,
  filterFunction: _propTypes2.default.filterFunction,
  header: _TwoPanelSelector2.default.propTypes.header,
  itemListWidth: _react.PropTypes.string,
  items: _react.PropTypes.arrayOf(_react.PropTypes.shape({
    label: _react.PropTypes.oneOfType([_react.PropTypes.node, _react.PropTypes.string]).isRequired,
    searchContent: _react.PropTypes.string.isRequired,
    value: _react.PropTypes.oneOfType([_react.PropTypes.number, _react.PropTypes.string])
  })).isRequired,
  itemsLoading: _TwoPanelSelector2.default.propTypes.itemsLoading,
  onItemClick: _TwoPanelSelector2.default.propTypes.onItemClick,
  onSearchChange: _TwoPanelSelector2.default.propTypes.onSearchChange,
  placeholderContent: _react.PropTypes.node,
  visibleItems: _react.PropTypes.number
};

var _default = UncontrolledTwoPanelSelector;
exports.default = _default;
;

var _temp = function () {
  if (typeof __REACT_HOT_LOADER__ === 'undefined') {
    return;
  }

  __REACT_HOT_LOADER__.register(UncontrolledTwoPanelSelector, 'UncontrolledTwoPanelSelector', 'src/two-panel/UncontrolledTwoPanelSelector.jsx');

  __REACT_HOT_LOADER__.register(_default, 'default', 'src/two-panel/UncontrolledTwoPanelSelector.jsx');
}();

;
module.exports = exports['default'];
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy90d28tcGFuZWwvVW5jb250cm9sbGVkVHdvUGFuZWxTZWxlY3Rvci5qc3giXSwibmFtZXMiOlsiVW5jb250cm9sbGVkVHdvUGFuZWxTZWxlY3RvciIsImFyZ3MiLCJzdGF0ZSIsImZpbHRlcmVkSXRlbXMiLCJwcm9wcyIsIml0ZW1zIiwic2VhcmNoVmFsdWUiLCJfZmlsdGVySXRlbXMiLCJiaW5kIiwidmFsdWUiLCJuZXdJdGVtcyIsImZpbHRlciIsImZpbHRlckZ1bmN0aW9uIiwiaXRlbSIsInNlYXJjaENvbnRlbnQiLCJzZXRTdGF0ZSIsIm5leHRQcm9wcyIsIl9oYW5kbGVTZWFyY2hDbGVhciIsIm9uU2VhcmNoQ2hhbmdlIiwib2JqIiwic2VsZWN0ZWRWYWx1ZSIsIm9uSXRlbUNsaWNrIiwiaGVhZGVyIiwiY29udGVudExvYWRpbmciLCJjb250ZW50IiwiaXRlbUxpc3RXaWR0aCIsInZpc2libGVJdGVtcyIsInNob3VsZFNob3dTZWFyY2giLCJsZW5ndGgiLCJfaGFuZGxlSXRlbVNlbGVjdCIsIl9oYW5kbGVTZWFyY2hDaGFuZ2UiLCJDb21wb25lbnQiLCJkZWZhdWx0UHJvcHMiLCJSZWdFeHAiLCJ0ZXN0IiwiaXRlbXNMb2FkaW5nIiwicGxhY2Vob2xkZXJDb250ZW50IiwicHJvcFR5cGVzIiwic3RyaW5nIiwiYXJyYXlPZiIsInNoYXBlIiwibGFiZWwiLCJvbmVPZlR5cGUiLCJub2RlIiwiaXNSZXF1aXJlZCIsIm51bWJlciJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBOzs7O0FBQ0E7Ozs7QUFFQTs7QUFDQTs7OztBQUNBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztJQUVNQSw0Qjs7O0FBQ0osMENBQXFCO0FBQUE7O0FBQUE7O0FBQUEsc0NBQU5DLElBQU07QUFBTkEsVUFBTTtBQUFBOztBQUFBLDZNQUNWQSxJQURVOztBQUVuQixVQUFLQyxLQUFMLEdB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b2xsZWRUd29QYW5lbFNlbGVjdG9yLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFJlYWN0LCB7IFByb3BUeXBlcyB9IGZyb20gJ3JlYWN0JztcbmltcG9ydCBkZWJvdW5jZSBmcm9tICdsb2Rhc2gvZGVib3VuY2UnO1xuXG5pbXBvcnQgeyBhdXRvYmluZCwgTk9PUCB9IGZyb20gJy4uL2Jhc2UvQmFzZSc7XG5pbXBvcnQgVHhsUHJvcFR5cGVzIGZyb20gJy4uL3V0aWxzL3Byb3BUeXBlcyc7XG5pbXBvcnQgVHdvUGFuZWxTZWxlY3RvciBmcm9tICcuL1R3b1BhbmVsU2VsZWN0b3InO1xuXG5jbGFzcyBVbmNvbnRyb2xsZWRUd29QYW5lbFNlbGVjdG9yIGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50IHtcbiAgY29uc3RydWN0b3IoLi4uYXJncykge1xuICAgIHN1cGVyKC4uLmFyZ3MpO1xuICAgIHRoaXMuc3RhdGUgPSB7XG4gICAgICBmaWx0ZXJlZEl0ZW1zOiB0aGlzLnByb3BzLml0ZW1zLFxuICAgICAgc2VhcmNoVmFsdWU6IG51bGwsXG4gICAgfTtcbiAgICB0aGlzLl9maWx0ZXJJdGVtcyA9IGRlYm91bmNlKHRoaXMuX2ZpbHRlckl0ZW1zLCAzMDApLmJpbmQodGhpcyk7XG4gIH1cblxuICBfZmlsdGVySXRlbXModmFsdWUsIGl0ZW1zID0gdGhpcy5wcm9wcy5pdGVtcykge1xuICAgIGxldCBuZXdJdGVtcztcblxuICAgIGlmICghdmFsdWUpIHtcbiAgICAgIG5ld0l0ZW1zID0gaXRlbXM7XG4gICAgfSBlbHNlIHtcbiAgICAgIG5ld0l0ZW1zID0gaXRlbXMuZmlsdGVyKGl0ZW0gPT4gdGhpcy5wcm9wcy5maWx0ZXJGdW5jdGlvbihpdGVtLnNlYXJjaENvbnRlbnQsIHZhbHVlKSk7XG4gICAgfVxuXG4gICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICBmaWx0ZXJlZEl0ZW1zOiBuZXdJdGVtcyxcbiAgICB9KTtcblxuICAgIHJldHVybiBuZXdJdGVtcztcbiAgfVxuXG4gIGNvbXBvbmVudFdpbGxSZWNlaXZlUHJvcHMobmV4dFByb3BzKSB7XG4gICAgaWYgKHRoaXMucHJvcHMuaXRlbXMgIT09IG5leHRQcm9wcy5pdGVtcykge1xuICAgICAgdGhpcy5fZmlsdGVySXRlbXModGhpcy5zdGF0ZS5zZWFyY2hWYWx1ZSk7XG4gICAgfVxuICB9XG5cbiAgQGF1dG9iaW5kXG4gIF9oYW5kbGVTZWFyY2hDaGFuZ2UoeyB2YWx1ZSB9KSB7XG4gICAgaWYgKCF2YWx1ZSkge1xuICAgICAgdGhpcy5faGFuZGxlU2VhcmNoQ2xlYXIoKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5fZmlsdGVySXRlbXModmFsdWUpO1xuXG4gICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgc2VhcmNoVmFsdWU6IHZhbHVlLFxuICAgICAgfSk7XG5cbiAgICAgIHRoaXMucHJvcHMub25TZWFyY2hDaGFuZ2UoeyB2YWx1ZSB9KTtcbiAgICB9XG4gIH1cblxuICBAYXV0b2JpbmRcbiAgX2hhbmRsZVNlYXJjaENsZWFyKCkge1xuICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgZmlsdGVyZWRJdGVtczogdGhpcy5wcm9wcy5pdGVtcyxcbiAgICAgIHNlYXJjaFZhbHVlOiBudWxsLFxuICAgIH0pO1xuICB9XG5cbiAgQGF1dG9iaW5kXG4gIF9oYW5kbGVJdGVtU2VsZWN0KG9iaikge1xuICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgc2VsZWN0ZWRWYWx1ZTogb2JqLnZhbHVlLFxuICAgIH0pO1xuICAgIHRoaXMucHJvcHMub25JdGVtQ2xpY2sob2JqKTtcbiAgfVxuXG4gIHJlbmRlcigpIHtcbiAgICBjb25zdCB7XG4gICAgICBoZWFkZXIsXG4gICAgICBjb250ZW50TG9hZGluZyxcbiAgICAgIGNvbnRlbnQsXG4gICAgICBpdGVtTGlzdFdpZHRoLFxuICAgICAgaXRlbXMsXG4gICAgICB2aXNpYmxlSXRlbXMsXG4gICAgICAuLi5wcm9wc1xuICAgIH0gPSB0aGlzLnByb3BzO1xuXG4gICAgY29uc3Qge1xuICAgICAgc2VsZWN0ZWRWYWx1ZSxcbiAgICAgIHNlYXJjaFZhbHVlLFxuICAgICAgZmlsdGVyZWRJdGVtcyxcbiAgICB9ID0gdGhpcy5zdGF0ZTtcblxuICAgIGNvbnN0IHNob3VsZFNob3dTZWFyY2ggPSBpdGVtcy5sZW5ndGggPiB2aXNpYmxlSXRlbXM7XG5cbiAgICByZXR1cm4gKFxuICAgICAgPFR3b1BhbmVsU2VsZWN0b3JcbiAgICAgICAgey4uLnByb3BzfVxuICAgICAgICBjb250ZW50TG9hZGluZz17Y29udGVudExvYWRpbmcgfHwgZmFsc2V9XG4gICAgICAgIGNvbnRlbnQ9e2NvbnRlbnR9XG4gICAgICAgIGhlYWRlcj17aGVhZGVyfVxuICAgICAgICBpdGVtTGlzdFdpZHRoPXtpdGVtTGlzdFdpZHRofVxuICAgICAgICBpdGVtcz17ZmlsdGVyZWRJdGVtc31cbiAgICAgICAgb25JdGVtQ2xpY2s9e3RoaXMuX2hhbmRsZUl0ZW1TZWxlY3R9XG4gICAgICAgIG9uU2VhcmNoQ2hhbmdlPXt0aGlzLl9oYW5kbGVTZWFyY2hDaGFuZ2V9XG4gICAgICAgIG9uU2VhcmNoQ2xlYXI9e3RoaXMuX2hhbmRsZVNlYXJjaENsZWFyfVxuICAgICAgICBvblNlYXJjaFN1Ym1pdD17Tk9PUH1cbiAgICAgICAgc2VhcmNoVmFsdWU9e3NlYXJjaFZhbHVlfVxuICAgICAgICBzZWxlY3RlZFZhbHVlPXtzZWxlY3RlZFZhbHVlfVxuICAgICAgICBzaG91bGRTaG93U2VhcmNoPXtzaG91bGRTaG93U2VhcmNofVxuICAgICAgICB2aXNpYmxlSXRlbXNDb3VudD17dmlzaWJsZUl0ZW1zfVxuICAgICAgLz5cbiAgICApO1xuICB9XG59XG5cblVuY29udHJvbGxlZFR3b1BhbmVsU2VsZWN0b3IuZGVmYXVsdFByb3BzID0ge1xuICBjb250ZW50TG9hZGluZzogZmFsc2UsXG4gIGZpbHRlckZ1bmN0aW9uOiAodmFsdWUsIHNlYXJjaFZhbHVlKSA9PiBuZXcgUmVnRXhwKHNlYXJjaFZhbHVlLCAnaScpLnRlc3QodmFsdWUpLFxuICBpdGVtTGlzdFdpZHRoOiAnNTAlJyxcbiAgaXRlbXNMb2FkaW5nOiBmYWxzZSxcbiAgb25TZWFyY2hDaGFuZ2U6IE5PT1AsXG4gIHBsYWNlaG9sZGVyQ29udGVudDogbnVsbCxcbiAgdmlzaWJsZUl0ZW1zOiAxMixcbn07XG5cblVuY29udHJvbGxlZFR3b1BhbmVsU2VsZWN0b3IucHJvcFR5cGVzID0ge1xuICBjb250ZW50OiBUd29QYW5lbFNlbGVjdG9yLnByb3BUeXBlcy5jb250ZW50LFxuICBjb250ZW50TG9hZGluZzogVHdvUGFuZWxTZWxlY3Rvci5wcm9wVHlwZXMuY29udGVudExvYWRpbmcsXG4gIGZpbHRlckZ1bmN0aW9uOiBUeGxQcm9wVHlwZXMuZmlsdGVyRnVuY3Rpb24sXG4gIGhlYWRlcjogVHdvUGFuZWxTZWxlY3Rvci5wcm9wVHlwZXMuaGVhZGVyLFxuICBpdGVtTGlzdFdpZHRoOiBQcm9wVHlwZXMuc3RyaW5nLFxuICBpdGVtczogUHJvcFR5cGVzLmFycmF5T2YoUHJvcFR5cGVzLnNoYXBlKHtcbiAgICBsYWJlbDogUHJvcFR5cGVzLm9uZU9mVHlwZShbUHJvcFR5cGVzLm5vZGUsIFByb3BUeXBlcy5zdHJpbmddKS5pc1JlcXVpcmVkLFxuICAgIHNlYXJjaENvbnRlbnQ6IFByb3BUeXBlcy5zdHJpbmcuaXNSZXF1aXJlZCxcbiAgICB2YWx1ZTogUHJvcFR5cGVzLm9uZU9mVHlwZShbUHJvcFR5cGVzLm51bWJlciwgUHJvcFR5cGVzLnN0cmluZ10pLFxuICB9KSkuaXNSZXF1aXJlZCxcbiAgaXRlbXNMb2FkaW5nOiBUd29QYW5lbFNlbGVjdG9yLnByb3BUeXBlcy5pdGVtc0xvYWRpbmcsXG4gIG9uSXRlbUNsaWNrOiBUd29QYW5lbFNlbGVjdG9yLnByb3BUeXBlcy5vbkl0ZW1DbGljayxcbiAgb25TZWFyY2hDaGFuZ2U6IFR3b1BhbmVsU2VsZWN0b3IucHJvcFR5cGVzLm9uU2VhcmNoQ2hhbmdlLFxuICBwbGFjZWhvbGRlckNvbnRlbnQ6IFByb3BUeXBlcy5ub2RlLFxuICB2aXNpYmxlSXRlbXM6IFByb3BUeXBlcy5udW1iZXIsXG59O1xuXG5leHBvcnQgZGVmYXVsdCBVbmNvbnRyb2xsZWRUd29QYW5lbFNlbGVjdG9yO1xuIl19